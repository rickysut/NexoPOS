"use strict";(self.webpackChunknexopos_4x=self.webpackChunknexopos_4x||[]).push([[331],{7331:(t,r,e)=>{e.r(r),e.d(r,{default:()=>c});var s=e(3658),i=e(1487),o=e(8094);function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);r&&(s=s.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),e.push.apply(e,s)}return e}function l(t){for(var r=1;r<arguments.length;r++){var e=null!=arguments[r]?arguments[r]:{};r%2?a(Object(e),!0).forEach((function(r){u(t,r,e[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}))}return t}function u(t,r,e){return(r=function(t){var r=function(t,r){if("object"!==n(t)||null===t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var s=e.call(t,r||"default");if("object"!==n(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"===n(r)?r:String(r)}(r))in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}const f={name:"ns-rewards-system",mounted:function(){this.loadForm(),console.log(this.rules)},data:function(){return{formValidation:new s.Z,form:{},nsSnackBar:i.kX,nsHttpClient:i.ih}},props:["submit-method","submit-url","return-url","src","rules"],methods:{__:o.__,submit:function(){var t=this;if(0===this.form.rules.length)return i.kX.error(this.$slots["error-no-rules"]?this.$slots["error-no-rules"]:(0,o.__)("No rules has been provided.")).subscribe();if(this.form.rules.filter((function(t){return t.filter((function(t){return!(t.value>=0)&&"hidden"!==t.type})).length>0})).length>0)return i.kX.error(this.$slots["error-no-valid-rules"]?this.$slots["error-no-valid-rules"]:(0,o.__)("No valid run were provided.")).subscribe();if(this.formValidation.validateForm(this.form).length>0)return i.kX.error(this.$slots["error-invalid-form"]?this.$slots["error-invalid-form"][0].text:(0,o.__)("Unable to proceed, the form is invalid."),this.$slots.okay?this.$slots.okay[0].text:(0,o.__)("OK")).subscribe();if(this.formValidation.disableForm(this.form),void 0===this.submitUrl)return i.kX.error(this.$slots["error-no-submit-url"]?this.$slots["error-no-submit-url"][0].text:(0,o.__)("Unable to proceed, no valid submit URL is defined."),this.$slots.okay?this.$slots.okay[0].text:(0,o.__)("OK")).subscribe();var r=l(l({},this.formValidation.extractForm(this.form)),{},{rules:this.form.rules.map((function(t){var r={};return t.forEach((function(t){r[t.name]=t.value})),r}))});i.ih[this.submitMethod?this.submitMethod.toLowerCase():"post"](this.submitUrl,r).subscribe((function(r){if("success"===r.status)return document.location=t.returnUrl;t.formValidation.enableForm(t.form)}),(function(r){t.formValidation.triggerError(t.form,r.response.data),t.formValidation.enableForm(t.form),i.kX.error(r.data.message||(0,o.__)("An unexpected error has occurred"),void 0,{duration:5e3}).subscribe()}))},handleGlobalChange:function(t){this.globallyChecked=t,this.rows.forEach((function(r){return r.$checked=t}))},loadForm:function(){var t=this;i.ih.get("".concat(this.src)).subscribe((function(r){t.form=t.parseForm(r.form)}))},parseForm:function(t){t.main.value=void 0===t.main.value?"":t.main.value,t.main=this.formValidation.createFields([t.main])[0];var r=0;for(var e in t.tabs)0===r&&(t.tabs[e].active=!0),t.tabs[e].active=void 0!==t.tabs[e].active&&t.tabs[e].active,t.tabs[e].fields=this.formValidation.createFields(t.tabs[e].fields),r++;return t},getRuleForm:function(){return JSON.parse(JSON.stringify(this.form.ruleForm))},addRule:function(){this.form.rules.push(this.getRuleForm())},removeRule:function(t){this.form.rules.splice(t,1)}}};const c=(0,e(1900).Z)(f,(function(){var t=this,r=t._self._c;return r("div",{staticClass:"form flex-auto flex flex-col",attrs:{id:"crud-form"}},[0===Object.values(t.form).length?r("div",{staticClass:"flex items-center justify-center flex-auto"},[r("ns-spinner")],1):t._e(),t._v(" "),Object.values(t.form).length>0?[r("div",{staticClass:"flex flex-col"},[r("div",{staticClass:"flex justify-between items-center"},[r("label",{staticClass:"font-bold my-2 text-primary",attrs:{for:"title"}},[t._t("title",(function(){return[t._v(t._s(t.__("No title Provided")))]}))],2),t._v(" "),r("div",{staticClass:"text-sm my-2 text-primary",attrs:{for:"title"}},[t.returnUrl?r("a",{staticClass:"rounded-full border ns-inset-button error px-2 py-1",attrs:{href:t.returnUrl}},[t._v("Return")]):t._e()])]),t._v(" "),r("div",{staticClass:"input-group flex border rounded overflow-hidden",class:t.form.main.disabled?"disabled":t.form.main.errors.length>0?"error":"info"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.form.main.value,expression:"form.main.value"}],staticClass:"flex-auto text-primary outline-none h-10 px-2",attrs:{disabled:t.form.main.disabled,type:"text"},domProps:{value:t.form.main.value},on:{blur:function(r){return t.formValidation.checkField(t.form.main)},change:function(r){return t.formValidation.checkField(t.form.main)},input:function(r){r.target.composing||t.$set(t.form.main,"value",r.target.value)}}}),t._v(" "),r("button",{staticClass:"outline-none px-4 h-10 border-l border-tertiary",attrs:{disabled:t.form.main.disabled},on:{click:function(r){return t.submit()}}},[t._t("save",(function(){return[t._v(t._s(t.__("Save")))]}))],2)]),t._v(" "),t.form.main.description&&0===t.form.main.errors.length?r("p",{staticClass:"text-xs text-primary py-1"},[t._v(t._s(t.form.main.description))]):t._e(),t._v(" "),t._l(t.form.main.errors,(function(e,s){return r("p",{key:s,staticClass:"text-xs py-1 text-error-tertiary"},[r("span",[t._t("error-required",(function(){return[t._v(t._s(e.identifier))]}))],2)])}))],2),t._v(" "),r("div",{staticClass:"flex -mx-4 mt-4",attrs:{id:"points-wrapper"}},[r("div",{staticClass:"w-full md:w-1/3 lg:1/4 px-4"},[r("div",{staticClass:"ns-box rounded shadow"},[r("div",{staticClass:"header ns-box-header border-b p-2"},[t._v(t._s(t.__("General")))]),t._v(" "),r("div",{staticClass:"body p-2"},t._l(t.form.tabs.general.fields,(function(t,e){return r("ns-field",{key:e,staticClass:"mb-2",attrs:{field:t}})})),1)]),t._v(" "),r("div",{staticClass:"ns-box rounded"},[r("div",{staticClass:"ns-body p-2 flex justify-between items-center my-3"},[t._t("add",(function(){return[r("span",{staticClass:"text-primary"},[t._v(t._s(t.__("Add Rule")))])]})),t._v(" "),r("div",{staticClass:"ns-button info"},[r("button",{staticClass:"rounded font-semibold flex items-center justify-center h-10 w-10",on:{click:function(r){return t.addRule()}}},[r("i",{staticClass:"las la-plus"})])])],2)])]),t._v(" "),r("div",{staticClass:"w-full md:w-2/3 lg:3/4 px-4 -m-3 flex flex-wrap items-start justify-start"},t._l(t.form.rules,(function(e,s){return r("div",{key:s,staticClass:"w-full md:w-1/2 p-3"},[r("div",{staticClass:"rounded shadow ns-box flex-auto"},[r("div",{staticClass:"body p-2"},t._l(e,(function(t,e){return r("ns-field",{key:e,staticClass:"mb-2",attrs:{field:t}})})),1),t._v(" "),r("div",{staticClass:"header border-t ns-box-footer p-2 flex justify-end"},[r("ns-button",{attrs:{type:"error"},on:{click:function(r){return t.removeRule(s)}}},[r("i",{staticClass:"las la-times"})])],1)])])})),0)])]:t._e()],2)}),[],!1,null,null,null).exports}}]);