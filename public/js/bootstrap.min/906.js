/*! For license information please see 906.js.LICENSE.txt */
"use strict";(self.webpackChunknexopos_4x=self.webpackChunknexopos_4x||[]).push([[906,178,140],{323:(t,e,r)=>{function n(t){POS.changeVisibleSection(t)}r.d(e,{Z:()=>n})},5494:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function s(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,(o=s.key,i=void 0,i=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var s=r.call(t,e||"default");if("object"!==n(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===n(i)?i:String(i)),s)}var o,i}r.d(e,{Z:()=>o});var o=function(){function t(e){var r=e.urls,n=e.options;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.printingURL={refund:"refund_printing_url",sale:"sale_printing_url",payment:"payment_printing_url"},this.urls=r,this.options=n}var e,r,n;return e=t,r=[{key:"processRegularPrinting",value:function(t,e){var r=document.querySelector("#printing-section");r&&r.remove();var n=this.urls[this.printingURL[e]].replace("{reference_id}",t),s=document.createElement("iframe");s.id="printing-section",s.className="hidden",s.src=n,document.body.appendChild(s),setTimeout((function(){document.querySelector("#printing-section").remove()}),5e3)}},{key:"process",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"aloud";"default"===this.options.ns_pos_printing_gateway?this.processRegularPrinting(t,e):this.processCustomPrinting(t,this.options.ns_pos_printing_gateway,e,r)}},{key:"processCustomPrinting",value:function(t,e,r){var n={printed:!1,reference_id:t,gateway:e,document:r,mode:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"aloud"};nsHooks.applyFilters("ns-custom-print",{params:n,promise:function(){return new Promise((function(t,e){e({status:"failed",message:__("The selected print gateway doesn't support this type of printing.","NsPrintAdapter")})}))}}).promise().then((function(t){nsSnackBar.success(t.message).subscribe()})).catch((function(t){nsSnackBar.error(t.message||__("An error unexpected occured while printing.")).subscribe()}))}}],r&&s(e.prototype,r),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},257:(t,e,r)=>{r.d(e,{$:()=>u});var n=r(1487),s=r(8094),o=r(1419),i=r(3287);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,o=void 0,o=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===a(o)?o:String(o)),n)}var s,o}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.product=e}var e,r,a;return e=t,(r=[{key:"run",value:function(t){var e=this;return new Promise((function(r,a){var c=new o.G({popupClass:"shadow-lg h-1/2-screen w-3/4 md:w-1/2 lg:w-2/5 xl:w-1/4 bg-white"}),u=e.product;if(!1===POS.options.getValue().ns_pos_show_quantity&&POS.processingAddQueue){if("enabled"===u.$original().stock_management&&"materialized"===u.$original().type){var l=POS.getStockUsage(u.$original().id,t.unit_quantity_id)-(u.quantity||0);if(1>parseFloat(t.$quantities().quantity)-l)return n.kX.error((0,s.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",(t.$quantities().quantity-l).toString())).subscribe()}r({quantity:1})}else c.open(i.Z,{resolve:r,reject:a,product:u,data:t})}))}}])&&c(e.prototype,r),a&&c(e,a),Object.defineProperty(e,"prototype",{writable:!1}),t}()},9693:(t,e,r)=>{r.d(e,{Z:()=>o});var n=r(8094);const s={name:"ns-numpad-plus",props:["value","currency","limit"],data:function(){return{screenValue:0,order:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keyRows:[[7,8,9].map((function(t){return{identifier:t,value:t}})),[4,5,6].map((function(t){return{identifier:t,value:t}})),[1,2,3].map((function(t){return{identifier:t,value:t}})),[{identifier:".",value:"."},{identifier:0,value:0},{identifier:"backspace",icon:"la-backspace"}],[{identifier:"next",value:(0,n.__)("Enter")}]]}},mounted:function(){var t=this;this.screenValue=this.value||0;var e=new Array(10).fill("").map((function(t,e){return e}));nsHotPress.create("numpad-keys").whenVisible([".is-popup"]).whenPressed(e,(function(e,r){t.inputValue({value:r})})),nsHotPress.create("numpad-backspace").whenVisible([".is-popup"]).whenPressed("backspace",(function(){return t.inputValue({identifier:"backspace"})})),nsHotPress.create("numpad-increase").whenVisible([".is-popup"]).whenPressed("+",(function(){return t.increaseBy({value:1})})),nsHotPress.create("numpad-dot").whenVisible([".is-popup"]).whenPressed(".",(function(){return t.inputValue({identifier:"."})})),nsHotPress.create("numpad-reduce").whenVisible([".is-popup"]).whenPressed("-",(function(){return t.increaseBy({value:-1})})),nsHotPress.create("numpad-save").whenVisible([".is-popup"]).whenPressed("enter",(function(){return t.inputValue({identifier:"next"})}))},watch:{value:function(){this.value.toString().length>0?this.screenValue=this.value:this.screenValue=""}},beforeDestroy:function(){nsHotPress.destroy("numpad-backspace"),nsHotPress.destroy("numpad-increase"),nsHotPress.destroy("numpad-reduce"),nsHotPress.destroy("numpad-save"),nsHotPress.destroy("numpad-dot")},methods:{increaseBy:function(t){this.screenValue=(parseFloat(t.value)+(parseFloat(this.screenValue)||0)).toString(),this.allSelected=!1},inputValue:function(t){if("next"!==t.identifier){if("backspace"===t.identifier)this.allSelected?(this.screenValue="0",this.allSelected=!1):this.screenValue=this.screenValue.toString().substr(0,this.screenValue.length-1);else if("."===t.identifier)this.allSelected?(this.screenValue="0.",this.allSelected=!1):null===this.screenValue.toString().match(/^[0-9][1-9]*\.[0-9]*$/)&&(this.screenValue=this.screenValue+=".");else if(t.value.toString().match(/^\d+$/)){if(this.limit>0&&this.screenValue.length>=this.limit)return;this.allSelected?(this.screenValue=t.value.toString(),this.allSelected=!1):(this.screenValue+=""+t.value.toString(),"percentage"===this.mode&&(this.screenValue=this.screenValue>100?100:this.screenValue))}this.$emit("changed",this.screenValue)}else this.$emit("next",this.screenValue)}}};const o=(0,r(1900).Z)(s,(function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"numpad-holder"}},t._l(t.keyRows,(function(r,n){return e("div",{key:n},[e("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-1 text-lg",attrs:{id:"numpad"}},[t._l(r,(function(n,s){return e("div",{key:s,staticClass:"select-none ns-numpad-key border-l border-b h-24 font-bold flex items-center justify-center cursor-pointer",class:1===r.length?"col-span-3":"",on:{click:function(e){return t.inputValue(n)}}},[void 0!==n.value?e("span",[t._v(t._s(n.value))]):t._e(),t._v(" "),n.icon?e("i",{staticClass:"las",class:n.icon}):t._e()])})),t._v(" "),t._t("numpad-footer")],2)])})),0)}),[],!1,null,null,null).exports},2906:(t,e,r)=>{r.r(e),r.d(e,{default:()=>Ot});var n=r(1419),s=r(3216),o=r(8094);function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}const c={name:"ns-pos-discount-popup",data:function(){return{finalValue:1,virtualStock:null,popupSubscription:null,mode:"",type:"",allSelected:!0,isLoading:!1,keys:[].concat(i([7,8,9].map((function(t){return{identifier:t,value:t}}))),i([4,5,6].map((function(t){return{identifier:t,value:t}}))),i([1,2,3].map((function(t){return{identifier:t,value:t}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},mounted:function(){var t=this;this.mode=this.$popupParams.reference.discount_type||"percentage",this.type=this.$popupParams.type,"percentage"===this.mode?this.finalValue=this.$popupParams.reference.discount_percentage||1:this.finalValue=this.$popupParams.reference.discount||1,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.$popup.close()}))},methods:{__:o.__,setPercentageType:function(t){this.mode=t},closePopup:function(){this.$popup.close()},inputValue:function(t){"next"===t.identifier?(this.$popupParams.onSubmit({discount_type:this.mode,discount_percentage:"percentage"===this.mode?this.finalValue:void 0,discount:"flat"===this.mode?this.finalValue:void 0}),this.$popup.close()):"backspace"===t.identifier?this.allSelected?(this.finalValue=0,this.allSelected=!1):(this.finalValue=this.finalValue.toString(),this.finalValue=this.finalValue.substr(0,this.finalValue.length-1)||0):this.allSelected?(this.finalValue=t.value,this.finalValue=parseFloat(this.finalValue),this.allSelected=!1):(this.finalValue+=""+t.value,this.finalValue=parseFloat(this.finalValue),"percentage"===this.mode&&(this.finalValue=this.finalValue>100?100:this.finalValue))}}};var u=r(1900);const l=(0,u.Z)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box shadow min-h-2/5-screen w-6/7-screen md:w-3/5-screen lg:w-3/5-screen xl:w-2/5-screen relative",attrs:{id:"discount-popup"}},[e("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[e("div",["product"===t.type?e("h1",{staticClass:"text-xl font-bold text-primary text-center"},[t._v(t._s(t.__("Product Discount")))]):t._e(),t._v(" "),"cart"===t.type?e("h1",{staticClass:"text-xl font-bold text-primary text-center"},[t._v(t._s(t.__("Cart Discount")))]):t._e()]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"h-16 ns-box-body text-white flex items-center justify-center",attrs:{id:"screen"}},[e("h1",{staticClass:"font-bold text-3xl"},["flat"===t.mode?e("span",[t._v(t._s(t._f("currency")(t.finalValue)))]):t._e(),t._v(" "),"percentage"===t.mode?e("span",[t._v(t._s(t.finalValue)+"%")]):t._e()])]),t._v(" "),e("div",{staticClass:"flex",attrs:{id:"switch-mode"}},[e("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"flat"===t.mode?"bg-tab-active":"bg-tab-inactive text-tertiary",on:{click:function(e){return t.setPercentageType("flat")}}},[t._v(t._s(t.__("Flat")))]),t._v(" "),e("hr",{staticClass:"border-r border-box-edge"}),t._v(" "),e("button",{staticClass:"outline-none w-1/2 py-2 flex items-center justify-center",class:"percentage"===t.mode?"bg-tab-active":"bg-tab-inactive text-tertiary",on:{click:function(e){return t.setPercentageType("percentage")}}},[t._v(t._s(t.__("Percentage")))])]),t._v(" "),e("div",{staticClass:"grid grid-flow-row grid-cols-3 grid-rows-3",attrs:{id:"numpad"}},t._l(t.keys,(function(r,n){return e("div",{key:n,staticClass:"text-primary ns-numpad-key info text-xl font-bold border h-24 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.inputValue(r)}}},[void 0!==r.value?e("span",[t._v(t._s(r.value))]):t._e(),t._v(" "),r.icon?e("i",{staticClass:"las",class:r.icon}):t._e()])})),0)])}),[],!1,null,null,null).exports;var d=r(2381),p=r(1487);function f(t){return function(t){if(Array.isArray(t))return v(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return v(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}const _={name:"sample-payment",props:["label","identifier"],data:function(){return{backValue:"0",number:parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join("")),order:null,settings:{},settingsSubscription:null,cursor:parseInt(ns.currency.ns_currency_precision),orderSubscription:null,allSelected:!0,keys:[].concat(f([7,8,9].map((function(t){return{identifier:t,value:t}}))),f([4,5,6].map((function(t){return{identifier:t,value:t}}))),f([1,2,3].map((function(t){return{identifier:t,value:t}}))),[{identifier:"backspace",icon:"la-backspace"},{identifier:0,value:0},{identifier:"next",icon:"la-share"}])}},computed:{amountShortcuts:function(){return null!==nsShortcuts.ns_pos_amount_shortcut?nsShortcuts.ns_pos_amount_shortcut.split("|"):[]}},mounted:function(){var t=this;this.orderSubscription=POS.order.subscribe((function(e){t.order=e})),this.settingsSubscription=POS.settings.subscribe((function(e){t.settings=e}));var e=new Array(10).fill("").map((function(t,e){return e}));nsHotPress.create("numpad-keys").whenVisible([".is-popup"]).whenPressed(e,(function(e,r){t.inputValue({value:r})})),nsHotPress.create("numpad-backspace").whenVisible([".is-popup"]).whenPressed("backspace",(function(){return t.inputValue({identifier:"backspace"})})),nsHotPress.create("numpad-save").whenVisible([".is-popup"]).whenPressed("enter",(function(){""===t.backValue?(t.$emit("submit"),t.backValue=0):t.inputValue({identifier:"next"})}))},beforeDestroy:function(){nsHotPress.destroy("numpad-keys"),nsHotPress.destroy("numpad-backspace"),nsHotPress.destroy("numpad-save")},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:o.__,toggleDiscount:function(){var t=this;if(void 0===this.settings.cart_discount||!0!==this.settings.cart_discount)return p.kX.error((0,o.__)("You're not allowed to add a discount on the cart.")).subscribe();n.G.show(l,{reference:this.order,type:"cart",onSubmit:function(e){POS.updateCart(t.order,e)}})},makeFullPayment:function(){var t=this;n.G.show(d.default,{title:(0,o.__)("Confirm Full Payment"),message:(0,o.__)("A full payment will be made using {paymentType} for {total}").replace("{paymentType}",this.label).replace("{total}",this.$options.filters.currency(this.order.total)),onAction:function(e){if(e){var r=POS.order.getValue();r.tendered<r.total&&POS.addPayment({value:t.order.total-r.tendered,identifier:t.identifier,selected:!1,label:t.label,readonly:!1}),t.$emit("submit"),t.backValue="0"}}})},increaseBy:function(t){var e=parseInt(1+new Array(this.cursor).fill("").map((function(t){return 0})).join(""));this.backValue=(parseFloat(t.value)*e+(parseFloat(this.backValue)||0)).toString(),this.allSelected=!1},inputValue:function(t){"next"===t.identifier?(POS.addPayment({value:parseFloat(this.backValue/this.number),identifier:this.identifier,selected:!1,label:this.label,readonly:!1}),this.backValue="0"):"backspace"===t.identifier?this.allSelected?(this.backValue="0",this.allSelected=!1):this.backValue=this.backValue.substr(1):t.value.toString().match(/^\d+$/)&&(this.allSelected?(this.backValue=t.value.toString(),this.allSelected=!1):(this.backValue+=t.value.toString(),"percentage"===this.mode&&(this.backValue=this.backValue>100?100:this.backValue))),"0"===this.backValue&&(this.backValue="")}}};const h=(0,u.Z)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-full w-full py-2"},[t.order?e("div",{staticClass:"px-2 pb-2"},[e("div",{staticClass:"grid grid-cols-2 gap-2"},[e("div",{staticClass:"h-16 flex justify-between items-center border elevation-surface info text-xl md:text-3xl p-2",attrs:{id:"details"}},[e("span",[t._v(t._s(t.__("Total"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.total)))])]),t._v(" "),e("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center border elevation-surface error text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(e){return t.toggleDiscount()}}},[e("span",[t._v(t._s(t.__("Discount"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.discount)))])]),t._v(" "),e("div",{staticClass:"h-16 flex justify-between items-center border elevation-surface success text-xl md:text-3xl p-2",attrs:{id:"paid"}},[e("span",[t._v(t._s(t.__("Paid"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),e("div",{staticClass:"h-16 flex justify-between items-center border elevation-surface warning text-xl md:text-3xl p-2",attrs:{id:"change"}},[e("span",[t._v(t._s(t.__("Change"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.change)))])]),t._v(" "),e("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-xl md:text-3xl p-2",attrs:{id:"change"}},[e("span",[t._v(t._s(t.__("Screen"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.backValue/t.number)))])])])]):t._e(),t._v(" "),e("div",{staticClass:"px-2 pb-2"},[e("div",{staticClass:"-mx-2 flex flex-wrap"},[e("div",{staticClass:"pl-2 pr-1 flex-auto"},[e("div",{staticClass:"grid grid-flow-row grid-cols-3 gap-2 grid-rows-3",staticStyle:{padding:"1px"},attrs:{id:"numpad"}},[t._l(t.keys,(function(r,n){return e("div",{key:n,staticClass:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer",staticStyle:{margin:"-1px"},on:{click:function(e){return t.inputValue(r)}}},[void 0!==r.value?e("span",[t._v(t._s(r.value))]):t._e(),t._v(" "),r.icon?e("i",{staticClass:"las",class:r.icon}):t._e()])})),t._v(" "),e("div",{staticClass:"hover:bg-green-500 col-span-3 bg-success-secondary border-success-tertiary text-2xl text-white border h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.makeFullPayment()}}},[t._v("\n                        "+t._s(t.__("Full Payment")))])],2)]),t._v(" "),e("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[e("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},t._l(t.amountShortcuts,(function(r,n){return e("div",{key:n,staticClass:"ns-numpad-key text-2xl border h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:r})}}},[e("span",[t._v(t._s(t._f("currency")(r)))])])})),0)])])])])}),[],!1,null,null,null).exports,m={name:"cash-payment",props:["identifier","label"],components:{samplePayment:h}};const b=(0,u.Z)(m,(function(){var t=this;return(0,t._self._c)("sample-payment",{attrs:{identifier:t.identifier,label:t.label},on:{submit:function(e){return t.$emit("submit")}}})}),[],!1,null,null,null).exports;const y={name:"creditcart-payment",props:["identifier"]};const x=(0,u.Z)(y,(function(){return(0,this._self._c)("h1",[this._v("Credit Card")])}),[],!1,null,null,null).exports;const g={name:"bank-payment",props:["identifier","label"],components:{samplePayment:h}};const w=(0,u.Z)(g,(function(){var t=this;return(0,t._self._c)("sample-payment",{attrs:{identifier:t.identifier,label:t.label},on:{submit:function(e){return t.$emit("submit")}}})}),[],!1,null,null,null).exports;var C=r(8321);const P={name:"ns-account-payment",components:{nsNumpad:C.Z},props:["identifier","label"],data:function(){return{subscription:null,screenValue:0,order:null}},methods:{__:o.__,handleChange:function(t){this.screenValue=t},proceedAddingPayment:function(t){var e=parseFloat(t),r=this.order.payments;return e<=0?p.kX.error((0,o.__)("Please provide a valid payment amount.")).subscribe():r.filter((function(t){return"account-payment"===t.identifier})).length>0?p.kX.error((0,o.__)("The customer account can only be used once per order. Consider deleting the previously used payment.")).subscribe():e>this.order.customer.account_amount?p.kX.error((0,o.__)("Not enough funds to add {amount} as a payment. Available balance {balance}.").replace("{amount}",this.$options.filters.currency(e)).replace("{balance}",this.$options.filters.currency(this.order.customer.account_amount))).subscribe():(POS.addPayment({value:e,identifier:"account-payment",selected:!1,label:this.label,readonly:!1}),this.order.customer.account_amount-=e,POS.selectCustomer(this.order.customer),void this.$emit("submit"))},proceedFullPayment:function(){this.proceedAddingPayment(this.order.total)},makeFullPayment:function(){var t=this;Popup.show(d.default,{title:(0,o.__)("Confirm Full Payment"),message:(0,o.__)("You're about to use {amount} from the customer account to make a payment. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(this.order.total)),onAction:function(e){e&&t.proceedFullPayment()}})}},mounted:function(){var t=this;this.subscription=POS.order.subscribe((function(e){return t.order=e}))},destroyed:function(){this.subscription.unsubscribe()}};const k=(0,u.Z)(P,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-full w-full py-2"},[t.order?e("div",{staticClass:"px-2 pb-2"},[e("div",{staticClass:"grid grid-cols-2 gap-2"},[e("div",{staticClass:"h-16 flex justify-between items-center elevation-surface border info text-xl md:text-3xl p-2",attrs:{id:"details"}},[e("span",[t._v(t._s(t.__("Total"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.total)))])]),t._v(" "),e("div",{staticClass:"cursor-pointer h-16 flex justify-between items-center elevation-surface error border text-xl md:text-3xl p-2",attrs:{id:"discount"},on:{click:function(e){return t.toggleDiscount()}}},[e("span",[t._v(t._s(t.__("Discount"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.discount)))])]),t._v(" "),e("div",{staticClass:"h-16 flex justify-between items-center elevation-surface success border text-xl md:text-3xl p-2",attrs:{id:"paid"}},[e("span",[t._v(t._s(t.__("Paid"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),e("div",{staticClass:"h-16 flex justify-between items-center elevation-surface warning border text-xl md:text-3xl p-2",attrs:{id:"change"}},[e("span",[t._v(t._s(t.__("Change"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.change)))])]),t._v(" "),e("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border success text-xl md:text-3xl p-2",attrs:{id:"change"}},[e("span",[t._v(t._s(t.__("Current Balance"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.customer.account_amount)))])]),t._v(" "),e("div",{staticClass:"col-span-2 h-16 flex justify-between items-center elevation-surface border text-primary text-xl md:text-3xl p-2",attrs:{id:"change"}},[e("span",[t._v(t._s(t.__("Screen"))+" : ")]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.screenValue)))])])])]):t._e(),t._v(" "),e("div",{staticClass:"px-2 pb-2"},[e("div",{staticClass:"-mx-2 flex flex-wrap"},[e("div",{staticClass:"pl-2 pr-1 flex-auto"},[e("ns-numpad",{attrs:{floating:!0},on:{changed:function(e){return t.handleChange(e)},next:function(e){return t.proceedAddingPayment(e)}},scopedSlots:t._u([{key:"numpad-footer",fn:function(){return[e("div",{staticClass:"hover:bg-success-tertiary col-span-3 bg-success-secondary text-2xl text-white border border-success-secondary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.makeFullPayment()}}},[t._v("\n                        "+t._s(t.__("Full Payment")))])]},proxy:!0}])})],1),t._v(" "),e("div",{staticClass:"w-1/2 md:w-72 pr-2 pl-1"},[e("div",{staticClass:"grid grid-flow-row grid-rows-1 gap-2"},[e("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:100})}}},[e("span",[t._v(t._s(t._f("currency")(100)))])]),t._v(" "),e("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:500})}}},[e("span",[t._v(t._s(t._f("currency")(500)))])]),t._v(" "),e("div",{staticClass:"elevation-surface border hoverable text-2xl text-primary h-16 flex items-center justify-center cursor-pointer",on:{click:function(e){return t.increaseBy({value:1e3})}}},[e("span",[t._v(t._s(t._f("currency")(1e3)))])])])])])])])}),[],!1,null,null,null).exports;var S=r(4140),j=r(2909);function O(t){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},O(t)}function T(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function L(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?T(Object(r),!0).forEach((function(e){E(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function E(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==O(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===O(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V(){V=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new E(n||[]);return s(i,"_invoke",{value:S(t,r,a)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",v="executing",_="completed",h={};function m(){}function b(){}function y(){}var x={};u(x,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g($([])));w&&w!==r&&n.call(w,i)&&(x=w);var C=y.prototype=m.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(s,o,i,a){var c=d(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==O(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,a)}),(function(t){r("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){r(t,n,e,s)}))}return o=o?o.then(s,s):s()}})}function S(e,r,n){var s=p;return function(o,i){if(s===v)throw new Error("Generator is already running");if(s===_){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=j(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===p)throw s=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=v;var u=d(e,r,n);if("normal"===u.type){if(s=n.done?_:f,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(s=_,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,s=e.iterator[n];if(s===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=d(s,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function T(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(T,this),this.reset(!0)}function $(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(O(e)+" is not iterable")}return b.prototype=y,s(C,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},P(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new k(l(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(C),u(C,c,"Generator"),u(C,i,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=$,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;L(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:$(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}function $(t,e,r,n,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}const N={name:"ns-pos-payment",data:function(){return{paymentTypesSubscription:null,paymentsType:[],order:null,showPayment:!1,orderSubscription:null,currentPaymentComponent:null}},computed:{activePayment:function(){var t;return(t=this.paymentsType.filter((function(t){return t.selected}))).length>0&&t[0]},expectedPayment:function(){var t=this.order.customer.group.minimal_credit_payment;return this.order.total*t/100}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){if("click-overlay"===e.event)t.closePopup()})),this.order=this.$popupParams.order,this.paymentTypesSubscription=POS.paymentsType.subscribe((function(e){t.paymentsType=e,e.filter((function(t){t.selected&&POS.selectedPaymentType.next(t)}))})),nsHooks.doAction("ns-pos-payment-mounted",this)},watch:{activePayment:function(t){this.loadPaymentComponent(t)}},destroyed:function(){this.paymentTypesSubscription.unsubscribe(),nsHooks.doAction("ns-pos-payment-destroyed",this)},methods:{__:o.__,resolveIfQueued:s.Z,loadPaymentComponent:function(t){switch(t.identifier){case"cash-payment":this.currentPaymentComponent=b;break;case"creditcard-payment":this.currentPaymentComponent=x;break;case"bank-payment":this.currentPaymentComponent=w;break;case"account-payment":this.currentPaymentComponent=k;break;default:this.currentPaymentComponent=h}},selectPayment:function(){var t,e=this;return(t=V().mark((function t(){var r;return V().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,r){n.G.show(j.Z,{label:(0,o.__)("Select Payment Gateway"),options:e.paymentsType.map((function(t){return{label:t.label,value:t.identifier}})),value:e.activePayment.identifier,resolve:t,reject:r})}));case 3:r=t.sent,e.select(e.paymentsType.filter((function(t){return t.identifier===r[0].value}))[0]),t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:case"end":return t.stop()}}),t,null,[[0,7]])})),function(){var e=this,r=arguments;return new Promise((function(n,s){var o=t.apply(e,r);function i(t){$(o,n,s,i,a,"next",t)}function a(t){$(o,n,s,i,a,"throw",t)}i(void 0)}))})()},select:function(t){this.showPayment=!1,POS.setPaymentActive(t)},closePopup:function(){this.$popup.close(),POS.selectedPaymentType.next(null)},deletePayment:function(t){POS.removePayment(t)},selectPaymentAsActive:function(t){this.select(this.paymentsType.filter((function(e){return e.identifier===t.target.value}))[0])},submitOrder:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.G.show(S.default);try{var s=L(L({},POS.order.getValue()),e);POS.submitOrder(s).then((function(e){r.close(),p.kX.success(e.message).subscribe(),POS.printOrderReceipt(e.data.order,"silent"),t.$popup.close()}),(function(t){r.close(),p.kX.error(t.message).subscribe()}))}catch(t){r.close(),p.kX.error(error.message).subscribe()}}}};const F=(0,u.Z)(N,(function(){var t=this,e=t._self._c;return t.order?e("div",{staticClass:"w-screen h-screen p-4 flex overflow-hidden",attrs:{id:"ns-payment-popup"}},[e("div",{staticClass:"flex flex-col flex-auto lg:flex-row shadow-xl"},[e("div",{staticClass:"w-full lg:w-56 lg:h-full flex justify-between px-2 lg:px-0 lg:block items-center lg:items-start"},[e("h3",{staticClass:"lg:hidden text-xl text-center my-4 font-bold lg:my-8"},[t._v(t._s(t.__("Gateway"))+" "),e("span",[t._v(": "+t._s(t.activePayment.label))])]),t._v(" "),e("div",{staticClass:"h-16 hidden lg:block"}),t._v(" "),e("ul",{staticClass:"hidden lg:block"},[t._l(t.paymentsType,(function(r){return e("li",{key:r.identifier,staticClass:"cursor-pointer ns-payment-gateway py-2 px-3",class:r.selected&&!t.showPayment?"ns-visible":"",on:{click:function(e){return t.select(r)}}},[t._v(t._s(r.label))])})),t._v(" "),e("li",{staticClass:"cursor-pointer py-2 px-3 ns-payment-list border-t mt-4 flex items-center justify-between",class:t.showPayment?"ns-visible":"",on:{click:function(e){t.showPayment=!0}}},[e("span",[t._v(t._s(t.__("Payment List")))]),t._v(" "),e("span",{staticClass:"px-2 rounded-full h-8 w-8 flex items-center justify-center ns-label"},[t._v(t._s(t.order.payments.length))])])],2),t._v(" "),e("ns-close-button",{staticClass:"lg:hidden",on:{click:function(e){return t.closePopup()}}})],1),t._v(" "),e("div",{staticClass:"overflow-hidden flex flex-col flex-auto"},[e("div",{staticClass:"flex flex-col flex-auto overflow-hidden"},[e("div",{staticClass:"h-12 hidden items-center justify-between lg:flex"},[e("div",[e("h3",{staticClass:"text-xl hidden lg:block text-center my-4 font-bold lg:my-8"},[t._v(t._s(t.__("Gateway"))+" "),e("span",{staticClass:"hidden-md"},[t._v(": "+t._s(t.activePayment.label))])])]),t._v(" "),e("div",{staticClass:"px-2"},[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),t.showPayment?t._e():e("div",{staticClass:"flex flex-auto ns-payment-wrapper overflow-y-auto"},[e(t.currentPaymentComponent,{tag:"component",attrs:{label:t.activePayment.label,identifier:t.activePayment.identifier},on:{submit:function(e){return t.submitOrder()}}})],1),t._v(" "),t.showPayment?e("div",{staticClass:"flex flex-auto ns-payment-wrapper overflow-y-auto p-2 flex-col"},[e("h3",{staticClass:"text-center font-bold py-2"},[t._v(t._s(t.__("List Of Payments")))]),t._v(" "),e("ul",{staticClass:"flex-auto"},[0===t.order.payments.length?e("li",{staticClass:"p-2 flex justify-center mb-2 items-center"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("No Payment added.")))])]):t._e(),t._v(" "),t._l(t.order.payments,(function(r,n){return e("li",{key:n,staticClass:"p-2 flex justify-between mb-2 items-center"},[e("span",[t._v(t._s(r.label))]),t._v(" "),e("div",{staticClass:"flex items-center"},[e("span",[t._v(t._s(t._f("currency")(r.value)))]),t._v(" "),e("button",{staticClass:"rounded-full h-8 w-8 flex items-center justify-center ml-2",on:{click:function(e){return t.deletePayment(r)}}},[e("i",{staticClass:"las la-trash-alt"})])])])}))],2)]):t._e()]),t._v(" "),e("div",{staticClass:"flex lg:hidden ns-payment-buttons"},[e("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 font-bold ns-payment-type-button",on:{click:function(e){return t.selectPayment()}}},[e("span",{staticClass:"text-sm"},[t._v(t._s(t.__("Payment Type")))])]),t._v(" "),t.order.tendered>=t.order.total?e("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-submit-button font-bold",on:{click:function(e){return t.submitOrder()}}},[e("span",{staticClass:"text-sm"},[t._v(t._s(t.__("Submit Payment")))])]):t._e(),t._v(" "),t.order.tendered<t.order.total?e("button",{staticClass:"flex items-center justify-center w-1/3 text-2xl flex-auto h-12 ns-layaway-button font-bold",on:{click:function(e){return t.submitOrder({payment_status:"unpaid"})}}},[e("span",{staticClass:"text-sm"},[t._v(t._s(t.__("Layaway")))])]):t._e(),t._v(" "),e("button",{staticClass:"w-1/3 flex ns-payment-button text-2xl flex-auto h-12 items-center justify-center font-bold",on:{click:function(e){t.showPayment=!0}}},[e("span",{staticClass:"text-sm mr-1"},[t._v(t._s(t.__("Payment List")))]),t._v(" "),e("span",{staticClass:"px-2 rounded-full h-6 w-6 text-xs flex items-center justify-center ns-label"},[t._v(t._s(t.order.payments.length))])])]),t._v(" "),e("div",{staticClass:"flex-col sm:flex-row w-full ns-payment-footer justify-end p-2 hidden lg:flex"},[e("div",{staticClass:"flex justify-end"},[t.order.tendered>=t.order.total?e("ns-button",{attrs:{type:t.order.tendered>=t.order.total?"success":"info"},on:{click:function(e){return t.submitOrder()}}},[e("span",[e("i",{staticClass:"las la-cash-register"}),t._v(" "+t._s(t.__("Submit Payment")))])]):t._e(),t._v(" "),t.order.tendered<t.order.total?e("ns-button",{attrs:{type:t.order.tendered>=t.order.total?"success":"info"},on:{click:function(e){return t.submitOrder({payment_status:"unpaid"})}}},[e("span",[e("i",{staticClass:"las la-bookmark"}),t._v(" "+t._s(t.__("Layaway"))+" â€” "+t._s(t._f("currency")(t.expectedPayment)))])]):t._e()],1)])])])]):t._e()}),[],!1,null,null,null).exports;r(3287);var A=r(257),Z=r(1951),D=r(5627);function G(t){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},G(t)}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,o=void 0,o=function(t,e){if("object"!==G(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===G(o)?o:String(o)),n)}var s,o}var R=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,r,n;return e=t,(r=[{key:"run",value:function(){var t=this;return new Promise((function(e,r){return 0===t.order.products.length?(p.kX.error((0,o.__)("You need to provide some products before proceeding.")).subscribe(),r(!1)):e(!0)}))}}])&&I(e.prototype,r),n&&I(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function X(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,o=void 0,o=function(t,e){if("object"!==q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===q(o)?o:String(o)),n)}var s,o}window.ProductsQueue=R;var H=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,r,s;return e=t,(r=[{key:"run",value:function(){var t=this;return new Promise((function(e,r){return void 0===t.order.customer?n.G.show(D.Z,{resolve:e,reject:r}):e(!0)}))}}])&&X(e.prototype,r),s&&X(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function U(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,o=void 0,o=function(t,e){if("object"!==Q(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===Q(o)?o:String(o)),n)}var s,o}window.CustomerQueue=H;var Y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,r,s;return e=t,(r=[{key:"run",value:function(){var t=this;return new Promise((function(e,r){n.G.show(F,{resolve:e,reject:r,order:t.order})}))}}])&&U(e.prototype,r),s&&U(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function M(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,o=void 0,o=function(t,e){if("object"!==W(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===W(o)?o:String(o)),n)}var s,o}window.PaymentQueue=Y;var z=r(1951).Z,B=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.order=e}var e,r,s;return e=t,(r=[{key:"run",value:function(){var t=this;return new Promise((function(e,r){if(void 0===t.order.type)return n.G.show(z,{resolve:e,reject:r});e(!0)}))}}])&&M(e.prototype,r),s&&M(e,s),Object.defineProperty(e,"prototype",{writable:!1}),t}();window.TypeQueue=B;var J=r(323),K=r(4054),tt=r(2867);const et={name:"ns-pos-hold-orders",data:function(){return{order:{},title:"",show:!0}},mounted:function(){this.popupCloser(),this.show=POS.getHoldPopupEnabled(),this.show||this.$popupParams.resolve({title:this.title}),this.$refs.reference.focus(),this.$refs.reference.select(),this.order=this.$popupParams.order,this.title=this.$popupParams.order.title||""},methods:{__:o.__,popupCloser:tt.Z,submitHold:function(){this.$popup.close(),this.$popupParams.resolve({title:this.title})}}};const rt=(0,u.Z)(et,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box shadow-lg w-6/7-screen md:w-3/7-screen lg:w-2/6-screen"},[e("div",{staticClass:"p-2 flex ns-box-header justify-between border-b items-center"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Hold Order")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex-auto ns-box-body"},[e("div",{staticClass:"border-b h-16 flex items-center justify-center"},[e("span",{staticClass:"text-5xl text-primary"},[t._v(t._s(t._f("currency")(t.order.total)))])]),t._v(" "),e("div",{staticClass:"p-2"},[e("div",{staticClass:"input-group border-2 info"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],ref:"reference",staticClass:"outline-none rounded border-2 p-2 w-full",attrs:{type:"text",placeholder:"Order Reference"},domProps:{value:t.title},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitHold()},input:function(e){e.target.composing||(t.title=e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"p-2"},[e("p",{staticClass:"text-secondary"},[t._v("\n                "+t._s(t.__("The current order will be set on hold. You can retrieve this order from the pending order button. Providing a reference to it might help you to identify the order more quickly."))+"\n            ")])])]),t._v(" "),e("div",{staticClass:"flex ns-box-footer"},[e("div",{staticClass:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-green-500 text-white font-semibold",on:{click:function(e){return t.submitHold()}}},[t._v("\n            "+t._s(t.__("Confirm"))+"\n        ")]),t._v(" "),e("div",{staticClass:"cursor-pointer w-1/2 py-3 flex justify-center items-center bg-error-secondary text-white font-semibold",on:{click:function(e){return t.$popup.close()}}},[t._v("\n            "+t._s(t.__("Cancel"))+"\n        ")])])])}),[],!1,null,null,null).exports;var nt=r(3658);const st={name:"ns-pos-note-popup",data:function(){return{validation:new nt.Z,fields:[{label:(0,o.__)("Note"),name:"note",value:"",description:(0,o.__)("More details about this order"),type:"textarea"},{label:(0,o.__)("Display On Receipt"),name:"note_visibility",value:"",options:[{label:(0,o.__)("Yes"),value:"visible"},{label:(0,o.__)("No"),value:"hidden"}],description:(0,o.__)("Will display the note on the receipt"),type:"switch"}]}},mounted:function(){var t=this;this.popupCloser(),this.fields.forEach((function(e){"note"===e.name?e.value=t.$popupParams.note:"note_visibility"===e.name&&(e.value=t.$popupParams.note_visibility)}))},methods:{__:o.__,popupResolver:s.Z,popupCloser:tt.Z,closePopup:function(){this.popupResolver(!1)},saveNote:function(){if(!this.validation.validateFields(this.fields)){var t=this.validation.validateFieldsErrors(this.fields);return this.validation.triggerFieldsErrors(this.fields,t),this.$forceUpdate(),console.log(this.fields),p.kX.error((0,o.__)("Unable to proceed the form is not valid.")).subscribe()}return this.popupResolver(this.validation.extractFields(this.fields))}}};const ot=(0,u.Z)(st,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/5-screen lg:w-2/5-screen"},[e("div",{staticClass:"p-2 flex justify-between items-center border-b ns-box-header"},[e("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Order Note")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2"},t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1),t._v(" "),e("div",{staticClass:"p-2 flex justify-end border-t ns-box-footer"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.saveNote()}}},[t._v("Save")])],1)])}),[],!1,null,null,null).exports;const it={name:"ns-pos-tax-popup",data:function(){return{validation:new nt.Z,tax_group:[],order:null,orderSubscriber:null,optionsSubscriber:null,options:{},tax_groups:[],activeTab:"",group_fields:[{label:(0,o.__)("Select Tax"),name:"tax_group_id",description:(0,o.__)("Define the tax that apply to the sale."),type:"select",disabled:!0,value:"",validation:"required",options:[]},{label:(0,o.__)("Type"),name:"tax_type",disabled:!0,value:"",description:(0,o.__)("Define how the tax is computed"),type:"select",validation:"required",options:[{label:(0,o.__)("Exclusive"),value:"exclusive"},{label:(0,o.__)("Inclusive"),value:"inclusive"}]}]}},mounted:function(){var t=this;this.loadGroups(),this.popupCloser(),this.activeTab=this.$popupParams.activeTab||"settings",this.group_fields.forEach((function(e){e.value=t.$popupParams[e.name]||void 0})),this.orderSubscriber=POS.order.subscribe((function(e){t.order=e})),this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e,["variable_vat","products_variable_vat"].includes(t.options.ns_pos_vat)&&t.group_fields.forEach((function(t){return t.disabled=!1}))}))},destroyed:function(){this.orderSubscriber.unsubscribe(),this.optionsSubscriber.unsubscribe()},methods:{__:o.__,popupCloser:tt.Z,popupResolver:s.Z,changeActive:function(t){this.activeTab=t},closePopup:function(){this.popupResolver(!1)},saveTax:function(){if(!this.validation.validateFields(this.group_fields))return p.kX.error((0,o.__)("Unable to proceed the form is not valid.")).subscribe();var t=this.validation.extractFields(this.group_fields);t.tax_groups=[],this.popupResolver(t)},loadGroups:function(){var t=this;p.ih.get("/api/nexopos/v4/taxes/groups").subscribe((function(e){t.groups=e,t.group_fields.forEach((function(e){"tax_group_id"===e.name&&(e.options=t.groups.map((function(t){return{label:t.name,value:t.id}})))}))}))}}};const at=(0,u.Z)(it,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[e("div",{staticClass:"p-2 flex justify-between items-center border-b ns-box-header"},[e("h3",{staticClass:"text-blog"},[t._v(t._s(t.__("Tax & Summary")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2 ns-box-body"},[e("ns-tabs",{attrs:{active:t.activeTab},on:{changeTab:function(e){return t.changeActive(e)}}},[e("ns-tabs-item",{attrs:{padding:"0",label:t.__("Settings"),identifier:"settings",active:!0}},[e("div",{staticClass:"p-2 border-b ns-box-body"},t._l(t.group_fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1),t._v(" "),e("div",{staticClass:"flex justify-end p-2"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.saveTax()}}},[t._v(t._s(t.__("Save")))])],1)]),t._v(" "),e("ns-tabs-item",{attrs:{padding:"0",label:t.__("Summary"),identifier:"summary",active:!1}},[t.order?e("div",{staticClass:"p-2"},[t._l(t.order.taxes,(function(r){return e("div",{key:r.id,staticClass:"mb-2 border shadow p-2 w-full flex justify-between items-center elevation-surface"},[e("span",[t._v(t._s(r.tax_name))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(r.tax_value)))])])})),t._v(" "),0===t.order.taxes.length?e("div",{staticClass:"p-2 text-center text-primary"},[t._v(t._s(t.__("No tax is active")))]):t._e()],2):t._e()]),t._v(" "),e("ns-tabs-item",{attrs:{padding:"0",label:t.__("Product Taxes"),identifier:"product_taxes",active:!1}},[t.order?e("div",{staticClass:"p-2"},[e("div",{staticClass:"border shadow p-2 w-full flex justify-between items-center elevation-surface"},[e("span",[t._v(t._s(t.__("Exclusive Taxes")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.products_exclusive_tax_value)))])]),t._v(" "),e("div",{staticClass:"border shadow p-2 w-full flex justify-between items-center elevation-surface"},[e("span",[t._v(t._s(t.__("Inclusive Taxes")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.products_inclusive_tax_value)))])])]):t._e()])],1)],1)])}),[],!1,null,null,null).exports;var ct=r(4527);const ut={name:"ns-pos-order-settings",mounted:function(){var t=this;nsHttpClient.get("/api/nexopos/v4/fields/ns.pos-order-settings").subscribe((function(e){e.forEach((function(e){e.value=t.$popupParams.order[e.name]||""})),t.fields=t.validation.createFields(e)}),(function(t){})),this.popupCloser()},data:function(){return{fields:[],validation:new nt.Z}},methods:{__,popupCloser,popupResolver,closePopup:function(){this.popupResolver(!1)},saveSettings:function(){var t=this.validation.extractFields(this.fields);this.popupResolver(t)}}};const lt=(0,u.Z)(ut,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg flex flex-col ns-box w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen lg:w-2/5-screen"},[e("div",{staticClass:"p-2 border-b ns-box-header items-center flex justify-between"},[e("h3",{staticClass:"text-semibold"},[t._v(t._s(t.__("Order Settings")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2 flex-auto border-b ns-box-body overflow-y-auto"},t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1),t._v(" "),e("div",{staticClass:"p-2 flex justify-end ns-box-footer"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.saveSettings()}}},[t._v(t._s(t.__("Save")))])],1)])}),[],!1,null,null,null).exports;var dt=r(9693);const pt={name:"ns-pos-product-price-product",components:{nsNumpad:C.Z,nsNumpadPlus:dt.Z},computed:{},data:function(){return{product:{},optionsSubscription:null,options:{}}},mounted:function(){var t=this;this.popupCloser(),this.product=this.$popupParams.product,this.optionsSubscription=POS.options.subscribe((function(e){t.options=e}))},beforeDestroy:function(){this.optionsSubscription.unsubscribe()},methods:{popupResolver,popupCloser,__,updateProductPrice:function(t){this.product.unit_price=t},resolveProductPrice:function(t){this.popupResolver(this.product.unit_price)}}};const ft=(0,u.Z)(pt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box shadow-lg w-95vw md:w-3/5-screen lg:w-2/5-screen"},[e("div",{staticClass:"popup-heading ns-box-header"},[e("h3",[t._v(t._s(t.__("Product Price")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.popupResolver(!1)}}})],1)]),t._v(" "),e("div",{staticClass:"flex flex-col ns-box-body"},[e("div",{staticClass:"h-16 flex items-center justify-center elevation-surface info font-bold"},[e("h2",{staticClass:"text-2xl"},[t._v(t._s(t._f("currency")(t.product.unit_price)))])]),t._v(" "),"default"===t.options.ns_pos_numpad?e("ns-numpad",{attrs:{floating:t.options.ns_pos_allow_decimal_quantities,value:t.product.unit_price},on:{changed:function(e){return t.updateProductPrice(e)},next:function(e){return t.resolveProductPrice(e)}}}):t._e(),t._v(" "),"advanced"===t.options.ns_pos_numpad?e("ns-numpad-plus",{attrs:{value:t.product.unit_price},on:{changed:function(e){return t.updateProductPrice(e)},next:function(e){return t.resolveProductPrice(e)}}}):t._e()],1)])}),[],!1,null,null,null).exports;var vt=r(2277);function _t(t){return _t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t(t)}function ht(){ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new L(n||[]);return s(i,"_invoke",{value:S(t,r,a)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",v="executing",_="completed",h={};function m(){}function b(){}function y(){}var x={};u(x,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(E([])));w&&w!==r&&n.call(w,i)&&(x=w);var C=y.prototype=m.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(s,o,i,a){var c=d(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==_t(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,a)}),(function(t){r("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){r(t,n,e,s)}))}return o=o?o.then(s,s):s()}})}function S(e,r,n){var s=p;return function(o,i){if(s===v)throw new Error("Generator is already running");if(s===_){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=j(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===p)throw s=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=v;var u=d(e,r,n);if("normal"===u.type){if(s=n.done?_:f,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(s=_,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,s=e.iterator[n];if(s===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=d(s,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(_t(e)+" is not iterable")}return b.prototype=y,s(C,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},P(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new k(l(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(C),u(C,c,"Generator"),u(C,i,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=E,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;T(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:E(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}function mt(t,e,r,n,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}const bt={name:"ns-pos-quick-product-popup",methods:{__:o.__,popupCloser:tt.Z,popupResolver:s.Z,close:function(){this.popupResolver(!1)},addProduct:function(){var t,e=this;return(t=ht().mark((function t(){var r,n,s,i;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.validation.extractFields(e.fields),n=e.fields.filter((function(t){return void 0===t.show||"function"==typeof t.show&&t.show(r)})),e.validation.validateFields(n)){t.next=5;break}return t.abrupt("return",p.kX.error((0,o.__)("Unable to proceed. The form is not valid.")).subscribe());case 5:return(s=e.validation.extractFields(n)).$original=function(){return{stock_management:"disabled",category_id:0,tax_group:e.tax_groups.filter((function(t){return parseInt(t.id)===parseInt(s.tax_group_id)}))[0],tax_group_id:s.tax_group_id,tax_type:s.tax_type}},"product"===s.product_type?(s.unit_name=e.units.filter((function(t){return t.id===s.unit_id}))[0].name,s.quantity=parseFloat(s.quantity),s.unit_price=parseFloat(s.unit_price),s.mode="custom",s.price_with_tax=s.unit_price,s.price_without_tax=s.unit_price,s.tax_value=0):(s.unit_name=(0,o.__)("N/A"),s.unit_price=0,s.quantity=1),t.next=10,POS.defineQuantities(s,e.units);case 10:i=t.sent,s.$quantities=function(){return i},s=POS.computeProductTax(s),POS.addToCart(s),e.close();case 15:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,s){var o=t.apply(e,r);function i(t){mt(o,n,s,i,a,"next",t)}function a(t){mt(o,n,s,i,a,"throw",t)}i(void 0)}))})()},loadData:function(){var t=this;this.loaded=!1,(0,vt.D)(nsHttpClient.get("/api/nexopos/v4/units"),nsHttpClient.get("/api/nexopos/v4/taxes/groups")).subscribe({next:function(e){t.units=e[0],t.tax_groups=e[1],t.fields.filter((function(r){"tax_group_id"===r.name&&(r.options=e[1].map((function(t){return{label:t.name,value:t.id}})),void 0!==e[1][0].id&&(r.value=e[1][0].id||t.options.ns_pos_tax_group)),"tax_type"===r.name&&(r.value=t.options.tax_type||"inclusive"),"unit_id"===r.name&&(r.value=t.options.ns_pos_quick_product_default_unit,r.options=e[0].map((function(t){return{label:t.name,value:t.id}})))})),t.buildForm()},error:function(t){}})},buildForm:function(){var t=this;this.fields=this.validation.createFields(this.fields),this.loaded=!0,setTimeout((function(){t.$popup.container.querySelector("#name").select()}),100)}},computed:{form:function(){return this.validation.extractFields(this.fields)}},data:function(){return{units:[],options:POS.options.getValue(),tax_groups:[],loaded:!1,validation:new nt.Z,fields:[{label:(0,o.__)("Name"),name:"name",type:"text",description:(0,o.__)("Provide a unique name for the product."),validation:"required"},{label:(0,o.__)("Product Type"),name:"product_type",type:"select",description:(0,o.__)("Define the product type."),options:[{label:(0,o.__)("Normal"),value:"product"},{label:(0,o.__)("Dynamic"),value:"dynamic"}],value:"product",validation:"required"},{label:(0,o.__)("Rate"),name:"rate",type:"text",description:(0,o.__)("In case the product is computed based on a percentage, define the rate here."),validation:"required",show:function(t){return"dynamic"===t.product_type}},{label:(0,o.__)("Unit Price"),name:"unit_price",type:"text",description:(0,o.__)("Define what is the sale price of the item."),validation:"",value:0,show:function(t){return"product"===t.product_type}},{label:(0,o.__)("Quantity"),name:"quantity",type:"text",value:1,description:(0,o.__)("Set the quantity of the product."),validation:"",show:function(t){return"product"===t.product_type}},{label:(0,o.__)("Unit"),name:"unit_id",type:"select",options:[],description:(0,o.__)("Assign a unit to the product."),validation:"",show:function(t){return"product"===t.product_type}},{label:(0,o.__)("Tax Type"),name:"tax_type",type:"select",options:[{label:(0,o.__)("Disabled"),value:""},{label:(0,o.__)("Inclusive"),value:"inclusive"},{label:(0,o.__)("Exclusive"),value:"exclusive"}],description:(0,o.__)("Define what is tax type of the item."),show:function(t){return"product"===t.product_type}},{label:(0,o.__)("Tax Group"),name:"tax_group_id",type:"select",options:[],description:(0,o.__)("Choose the tax group that should apply to the item."),show:function(t){return"product"===t.product_type}}]}},mounted:function(){this.popupCloser(),this.loadData()}};const yt=(0,u.Z)(bt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-95vw flex flex-col h-95vh shadow-lg md:w-3/5-screen lg:w-2/5-screen md:h-3/5-screen ns-box"},[e("div",{staticClass:"header ns-box-header border-b flex justify-between p-2 items-center"},[e("h3",[t._v(t._s(t.__("Product / Service")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"ns-box-body p-2 flex-auto overflow-y-auto"},[t.loaded?t._e():e("div",{staticClass:"h-full w-full flex justify-center items-center"},[e("ns-spinner")],1),t._v(" "),t.loaded?[t._l(t.fields,(function(r,n){return[r.show&&r.show(t.form)||!r.show?e("ns-field",{key:n,attrs:{field:r}}):t._e()]}))]:t._e()],2),t._v(" "),e("div",{staticClass:"ns-box-footer border-t flex justify-between p-2"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.addProduct()}}},[t._v(t._s(t.__("Create")))])],1)])])}),[],!1,null,null,null).exports;function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function gt(){gt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new L(n||[]);return s(i,"_invoke",{value:S(t,r,a)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",v="executing",_="completed",h={};function m(){}function b(){}function y(){}var x={};u(x,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(E([])));w&&w!==r&&n.call(w,i)&&(x=w);var C=y.prototype=m.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(s,o,i,a){var c=d(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==xt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,a)}),(function(t){r("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){r(t,n,e,s)}))}return o=o?o.then(s,s):s()}})}function S(e,r,n){var s=p;return function(o,i){if(s===v)throw new Error("Generator is already running");if(s===_){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=j(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===p)throw s=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=v;var u=d(e,r,n);if("normal"===u.type){if(s=n.done?_:f,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(s=_,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,s=e.iterator[n];if(s===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=d(s,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(xt(e)+" is not iterable")}return b.prototype=y,s(C,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},P(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new k(l(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(C),u(C,c,"Generator"),u(C,i,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=E,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;T(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:E(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}function wt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ct(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?wt(Object(r),!0).forEach((function(e){Pt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):wt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Pt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==xt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===xt(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kt(t,e,r,n,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}function St(t){return function(){var e=this,r=arguments;return new Promise((function(n,s){var o=t.apply(e,r);function i(t){kt(o,n,s,i,a,"next",t)}function a(t){kt(o,n,s,i,a,"throw",t)}i(void 0)}))}}const jt={name:"ns-pos-cart",data:function(){return{popup:null,products:[],visibleSection:null,visibleSectionSubscriber:null,optionsSubscriber:null,options:{},typeSubscribe:null,orderSubscribe:null,productSubscribe:null,settingsSubscribe:null,settings:{},types:[],order:{}}},computed:{selectedType:function(){return this.order.type?this.order.type.label:"N/A"},isVisible:function(){return"cart"===this.visibleSection},customerName:function(){return this.order.customer?this.order.customer.name:"N/A"},couponName:function(){return(0,o.__)("Apply Coupon")}},mounted:function(){var t=this;for(var e in this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e})),this.typeSubscribe=POS.types.subscribe((function(e){return t.types=e})),this.orderSubscribe=POS.order.subscribe((function(e){t.order=e})),this.productSubscribe=POS.products.subscribe((function(e){t.products=e,t.$forceUpdate()})),this.settingsSubscribe=POS.settings.subscribe((function(e){t.settings=e})),this.visibleSectionSubscriber=POS.visibleSection.subscribe((function(e){t.visibleSection=e})),nsShortcuts)["ns_pos_keyboard_hold_order"].includes(e)&&nsHotPress.create("ns_pos_keyboard_hold_order").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.holdOrder()})),["ns_pos_keyboard_payment"].includes(e)&&nsHotPress.create("ns_pos_keyboard_payment").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.payOrder()})),["ns_pos_keyboard_shipping"].includes(e)&&nsHotPress.create("ns_pos_keyboard_shipping").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.openShippingPopup()})),["ns_pos_keyboard_note"].includes(e)&&nsHotPress.create("ns_pos_keyboard_note").whenNotVisible([".is-popup"]).whenPressed(nsShortcuts[e],(function(e){e.preventDefault(),t.openNotePopup()}))},destroyed:function(){this.visibleSectionSubscriber.unsubscribe(),this.typeSubscribe.unsubscribe(),this.orderSubscribe.unsubscribe(),this.productSubscribe.unsubscribe(),this.settingsSubscribe.unsubscribe(),this.optionsSubscriber.unsubscribe(),nsHotPress.destroy("ns_pos_keyboard_hold_order"),nsHotPress.destroy("ns_pos_keyboard_payment"),nsHotPress.destroy("ns_pos_keyboard_shipping"),nsHotPress.destroy("ns_pos_keyboard_note")},methods:{__:o.__,switchTo:J.Z,openAddQuickProduct:function(){new Promise((function(t,e){n.G.show(yt,{resolve:t,reject:e})})).then((function(t){})).catch((function(t){}))},summarizeCoupons:function(){var t=this.order.coupons.map((function(t){return t.value}));return t.length>0?t.reduce((function(t,e){return t+e})):0},changeProductPrice:function(t){var e=this;return St(gt().mark((function r(){var s,i;return gt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.settings.edit_purchase_price){r.next=2;break}return r.abrupt("return",p.kX.error((0,o.__)("You don't have the right to edit the purchase price.")).subscribe());case 2:if("dynamic"!==t.product_type){r.next=4;break}return r.abrupt("return",p.kX.error((0,o.__)("Dynamic product can't have their price updated.")).subscribe());case 4:if(!e.settings.unit_price_editable){r.next=25;break}return r.prev=5,r.next=8,new Promise((function(e,r){return n.G.show(ft,{product:Object.assign({},t),resolve:e,reject:r})}));case 8:return s=r.sent,i=Ct(Ct({},t.$quantities()),{custom_price_edit:s}),t.$quantities=function(){return i},t.mode="custom",t=POS.computeProductTax(t),POS.recomputeProducts(POS.products.getValue()),POS.refreshCart(),r.abrupt("return",p.kX.success((0,o.__)("The product price has been updated.")).subscribe());case 18:if(r.prev=18,r.t0=r.catch(5),!1===r.t0){r.next=23;break}throw p.kX.error(r.t0).subscribe(),r.t0;case 23:r.next=26;break;case 25:return r.abrupt("return",p.kX.error((0,o.__)("The editable price feature is disabled.")).subscribe());case 26:case"end":return r.stop()}}),r,null,[[5,18]])})))()},selectCoupon:function(){return St(gt().mark((function t(){return gt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){n.G.show(ct.Z,{resolve:t,reject:e})}));case 3:t.sent,t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))()},defineOrderSettings:function(){var t=this;return St(gt().mark((function e(){var r;return gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.settings.edit_settings){e.next=2;break}return e.abrupt("return",p.kX.error((0,o.__)("You're not allowed to edit the order settings.")).subscribe());case 2:return e.prev=2,e.next=5,new Promise((function(e,r){n.G.show(lt,{resolve:e,reject:r,order:t.order})}));case 5:r=e.sent,POS.order.next(Ct(Ct({},t.order),r)),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:case"end":return e.stop()}}),e,null,[[2,9]])})))()},openNotePopup:function(){var t=this;return St(gt().mark((function e(){var r,s;return gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,r){var s=t.order.note,o=t.order.note_visibility;n.G.show(ot,{resolve:e,reject:r,note:s,note_visibility:o})}));case 3:r=e.sent,s=Ct(Ct({},t.order),r),POS.order.next(s),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),!1!==e.t0&&p.kX.error(e.t0.message).subscribe();case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()},selectTaxGroup:function(){var t=arguments,e=this;return St(gt().mark((function r(){var s,o,i;return gt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=t.length>0&&void 0!==t[0]?t[0]:"settings",r.prev=1,r.next=4,new Promise((function(t,r){var o=e.order.taxes,i=e.order.tax_group_id,a=e.order.tax_type;n.G.show(at,{resolve:t,reject:r,taxes:o,tax_group_id:i,tax_type:a,activeTab:s})}));case 4:o=r.sent,i=Ct(Ct({},e.order),o),POS.order.next(i),POS.refreshCart(),r.next=12;break;case 10:r.prev=10,r.t0=r.catch(1);case 12:case"end":return r.stop()}}),r,null,[[1,10]])})))()},openTaxSummary:function(){this.selectTaxGroup("summary")},voidOngoingOrder:function(){POS.voidOrder(this.order)},holdOrder:function(){var t=this;return St(gt().mark((function e(){var r,s,i;return gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("hold"!==t.order.payment_status&&t.order.payments.length>0)){e.next=2;break}return e.abrupt("return",p.kX.error((0,o.__)("Unable to hold an order which payment status has been updated already.")).subscribe());case 2:r=p.kq.applyFilters("ns-hold-queue",[R,H,B]),e.t0=gt().keys(r);case 4:if((e.t1=e.t0()).done){e.next=18;break}return s=e.t1.value,e.prev=6,i=new r[s](t.order),e.next=10,i.run();case 10:e.sent,e.next=16;break;case 13:return e.prev=13,e.t2=e.catch(6),e.abrupt("return",!1);case 16:e.next=4;break;case 18:p.kq.applyFilters("ns-override-hold-popup",(function(){new Promise((function(e,r){n.G.show(rt,{resolve:e,reject:r,order:t.order})})).then((function(e){t.order.title=e.title,t.order.payment_status="hold",POS.order.next(t.order);var r=n.G.show(S.default);POS.submitOrder().then((function(t){r.close(),POS.printOrderReceipt(t.data.order,"silent"),p.kX.success(t.message).subscribe()}),(function(t){r.close(),POS.printOrderReceipt(e.data.order,"silent"),p.kX.error(t.message).subscribe()}))}))}))();case 20:case"end":return e.stop()}}),e,null,[[6,13]])})))()},openDiscountPopup:function(t,e){return this.settings.products_discount||"product"!==e?this.settings.cart_discount||"cart"!==e?void n.G.show(l,{reference:t,type:e,onSubmit:function(r){"product"===e?POS.updateProduct(t,r):"cart"===e&&POS.updateCart(t,r)}},{popupClass:"bg-white h:2/3 shadow-lg xl:w-1/4 lg:w-2/5 md:w-2/3 w-full"}):p.kX.error((0,o.__)("You're not allowed to add a discount on the cart.")).subscribe():p.kX.error((0,o.__)("You're not allowed to add a discount on the product.")).subscribe()},selectCustomer:function(){n.G.show(D.Z)},toggleMode:function(t){if(!this.options.ns_pos_allow_wholesale_price)return p.kX.error((0,o.__)("Unable to change the price mode. This feature has been disabled.")).subscribe();"normal"===t.mode?n.G.show(d.default,{title:(0,o.__)("Enable WholeSale Price"),message:(0,o.__)("Would you like to switch to wholesale price ?"),onAction:function(e){e&&POS.updateProduct(t,{mode:"wholesale"})}}):n.G.show(d.default,{title:(0,o.__)("Enable Normal Price"),message:(0,o.__)("Would you like to switch to normal price ?"),onAction:function(e){e&&POS.updateProduct(t,{mode:"normal"})}})},remove:function(t){n.G.show(d.default,{title:(0,o.__)("Confirm Your Action"),message:(0,o.__)("Would you like to delete this product ?"),onAction:function(e){e&&POS.removeProduct(t)}})},allowQuantityModification:function(t){return"product"===t.product_type},changeQuantity:function(t){this.allowQuantityModification(t)&&new A.$(t).run({unit_quantity_id:t.unit_quantity_id,unit_name:t.unit_name,$quantities:t.$quantities}).then((function(e){POS.updateProduct(t,e)}))},payOrder:function(){var t=this;return St(gt().mark((function e(){var r,n,s;return gt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=p.kq.applyFilters("ns-pay-queue",[R,H,B,Y]),e.t0=gt().keys(r);case 2:if((e.t1=e.t0()).done){e.next=16;break}return n=e.t1.value,e.prev=4,s=new r[n](t.order),e.next=8,s.run();case 8:e.sent,e.next=14;break;case 11:return e.prev=11,e.t2=e.catch(4),e.abrupt("return",!1);case 14:e.next=2;break;case 16:case"end":return e.stop()}}),e,null,[[4,11]])})))()},openOrderType:function(){n.G.show(Z.Z)},openShippingPopup:function(){n.G.show(K.Z)}}};const Ot=(0,u.Z)(jt,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex-auto flex flex-col",attrs:{id:"pos-cart"}},["cart"===t.visibleSection?e("div",{staticClass:"flex pl-2 ns-tab",attrs:{id:"tools"}},[e("div",{staticClass:"flex cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 font-semibold active tab",on:{click:function(e){return t.switchTo("cart")}}},[e("span",[t._v(t._s(t.__("Cart")))]),t._v(" "),t.order?e("span",{staticClass:"flex items-center justify-center text-sm rounded-full h-6 w-6 bg-green-500 text-white ml-1"},[t._v(t._s(t.order.products.length))]):t._e()]),t._v(" "),e("div",{staticClass:"cursor-pointer rounded-tl-lg rounded-tr-lg px-3 py-2 border-t border-r border-l inactive tab",on:{click:function(e){return t.switchTo("grid")}}},[t._v("\n            "+t._s(t.__("Products"))+"\n        ")])]):t._e(),t._v(" "),e("div",{staticClass:"rounded shadow ns-tab-item flex-auto flex overflow-hidden"},[e("div",{staticClass:"cart-table flex flex-auto flex-col overflow-hidden"},[e("div",{staticClass:"w-full p-2 border-b",attrs:{id:"cart-toolbox"}},[e("div",{staticClass:"border rounded overflow-hidden"},[e("div",{staticClass:"flex flex-wrap"},[e("div",{staticClass:"ns-button"},[e("button",{staticClass:"w-full h-10 px-3 outline-none",on:{click:function(e){return t.openNotePopup()}}},[e("i",{staticClass:"las la-comment"}),t._v(" "),e("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Comments")))])])]),t._v(" "),e("hr",{staticClass:"h-10",staticStyle:{width:"1px"}}),t._v(" "),e("div",{staticClass:"ns-button"},[e("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.selectTaxGroup()}}},[e("i",{staticClass:"las la-balance-scale-left"}),t._v(" "),e("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Taxes")))]),t._v(" "),t.order.taxes&&t.order.taxes.length>0?e("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},[t._v(t._s(t.order.taxes.length))]):t._e()])]),t._v(" "),e("hr",{staticClass:"h-10",staticStyle:{width:"1px"}}),t._v(" "),e("div",{staticClass:"ns-button"},[e("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.selectCoupon()}}},[e("i",{staticClass:"las la-tags"}),t._v(" "),e("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Coupons")))]),t._v(" "),t.order.coupons&&t.order.coupons.length>0?e("span",{staticClass:"ml-1 rounded-full flex items-center justify-center h-6 w-6 bg-info-secondary text-white"},[t._v(t._s(t.order.coupons.length))]):t._e()])]),t._v(" "),e("hr",{staticClass:"h-10",staticStyle:{width:"1px"}}),t._v(" "),e("div",{staticClass:"ns-button"},[e("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.defineOrderSettings()}}},[e("i",{staticClass:"las la-tools"}),t._v(" "),e("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Settings")))])])]),t._v(" "),e("hr",{staticClass:"h-10",staticStyle:{width:"1px"}}),t._v(" "),"yes"===t.options.ns_pos_quick_product?e("div",{staticClass:"ns-button"},[e("button",{staticClass:"w-full h-10 px-3 outline-none flex items-center",on:{click:function(e){return t.openAddQuickProduct()}}},[e("i",{staticClass:"las la-plus"}),t._v(" "),e("span",{staticClass:"ml-1 hidden md:inline-block"},[t._v(t._s(t.__("Product")))])])]):t._e(),t._v(" "),e("hr",{staticClass:"h-10",staticStyle:{width:"1px"}})])])]),t._v(" "),e("div",{staticClass:"w-full text-primary font-semibold flex",attrs:{id:"cart-table-header"}},[e("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0"},[t._v(t._s(t.__("Product")))]),t._v(" "),e("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border-b border-t-0"},[t._v(t._s(t.__("Quantity")))]),t._v(" "),e("div",{staticClass:"hidden lg:flex lg:w-1/6 p-2 border border-r-0 border-t-0"},[t._v(t._s(t.__("Total")))])]),t._v(" "),e("div",{staticClass:"flex flex-auto flex-col overflow-auto",attrs:{id:"cart-products-table"}},[0===t.products.length?e("div",{staticClass:"text-primary flex"},[e("div",{staticClass:"w-full text-center py-4 border-b"},[e("h3",[t._v(t._s(t.__("No products added...")))])])]):t._e(),t._v(" "),t._l(t.products,(function(r,n){return e("div",{key:r.barcode,staticClass:"product-item flex",attrs:{"product-index":n}},[e("div",{staticClass:"w-full lg:w-4/6 p-2 border border-l-0 border-t-0"},[e("div",{staticClass:"flex justify-between product-details mb-1"},[e("h3",{staticClass:"font-semibold"},[t._v("\n                                "+t._s(r.name)+" â€” "+t._s(r.unit_name)+"\n                            ")]),t._v(" "),e("div",{staticClass:"-mx-1 flex product-options"},[e("div",{staticClass:"px-1"},[e("a",{staticClass:"hover:text-error-secondary cursor-pointer outline-none border-dashed py-1 border-b border-error-secondary text-sm",on:{click:function(e){return t.remove(r)}}},[e("i",{staticClass:"las la-trash text-xl"})])]),t._v(" "),t.options.ns_pos_allow_wholesale_price&&t.allowQuantityModification(r)?e("div",{staticClass:"px-1"},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b text-sm",class:"wholesale"===r.mode?"text-success-secondary border-success-secondary":"border-info-primary",on:{click:function(e){return t.toggleMode(r)}}},[e("i",{staticClass:"las la-award text-xl"})])]):t._e()])]),t._v(" "),e("div",{staticClass:"flex justify-between product-controls"},[e("div",{staticClass:"-mx-1 flex flex-wrap"},[e("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b text-sm",class:"wholesale"===r.mode?"text-success-secondary hover:text-success-secondary border-success-secondary":"border-info-primary",on:{click:function(e){return t.changeProductPrice(r)}}},[t._v(t._s(t.__("Price"))+" : "+t._s(t._f("currency")(r.unit_price)))])]),t._v(" "),e("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1"},[t.allowQuantityModification(r)?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openDiscountPopup(r,"product")}}},[t._v(t._s(t.__("Discount"))+" "),"percentage"===r.discount_type?e("span",[t._v(t._s(r.discount_percentage)+"%")]):t._e(),t._v(" : "+t._s(t._f("currency")(r.discount)))]):t._e()]),t._v(" "),e("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[t.allowQuantityModification(r)?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.changeQuantity(r)}}},[t._v(t._s(t.__("Quantity"))+": "+t._s(r.quantity))]):t._e()]),t._v(" "),e("div",{staticClass:"px-1 w-1/2 md:w-auto mb-1 lg:hidden"},[e("span",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm"},[t._v(t._s(t.__("Total"))+": "+t._s(t._f("currency")(r.total_price)))])])])])]),t._v(" "),e("div",{staticClass:"hidden lg:flex w-1/6 p-2 border-b items-center justify-center",class:t.allowQuantityModification(r)?"cursor-pointer ns-numpad-key":"",on:{click:function(e){return t.changeQuantity(r)}}},[t.allowQuantityModification(r)?e("span",{staticClass:"border-b border-dashed border-info-primary p-2"},[t._v(t._s(r.quantity))]):t._e()]),t._v(" "),e("div",{staticClass:"hidden lg:flex w-1/6 p-2 border border-r-0 border-t-0 items-center justify-center"},[t._v(t._s(t._f("currency")(r.total_price)))])])}))],2),t._v(" "),e("div",{staticClass:"flex",attrs:{id:"cart-products-summary"}},["both"===t.visibleSection?e("table",{staticClass:"table ns-table w-full text-sm"},[e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.selectCustomer()}}},[t._v(t._s(t.__("Customer"))+": "+t._s(t.customerName))])]),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[t._v(t._s(t.__("Sub Total")))]),t._v(" "),e("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.order.subtotal)))])]),t._v(" "),t.order.coupons.length>0?e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}}),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.selectCoupon()}}},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),e("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.summarizeCoupons())))])]):t._e(),t._v(" "),e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openOrderType()}}},[t._v(t._s(t.__("Type"))+": "+t._s(t.selectedType))])]),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("span",[t._v(t._s(t.__("Discount")))]),t._v(" "),"percentage"===t.order.discount_type?e("span",[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?e("span",[t._v("("+t._s(t.__("Flat"))+")")]):t._e()]),t._v(" "),e("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openDiscountPopup(t.order,"cart")}}},[t._v(t._s(t._f("currency")(t.order.discount)))])])]),t._v(" "),t.order.type&&"delivery"===t.order.type.identifier?e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}}),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openShippingPopup()}}},[t._v(t._s(t.__("Shipping")))])]),t._v(" "),e("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.order.shipping)))])]):t._e(),t._v(" "),e("tr",{staticClass:"success"},[e("td",{staticClass:"border p-2",attrs:{width:"200"}},[t.order&&"exclusive"===t.options.ns_pos_tax_type||t.order&&"inclusive"===t.options.ns_pos_tax_type?["yes"===t.options.ns_pos_price_with_tax?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("With Tax"))+": "+t._s(t._f("currency")(t.order.total_tax_value+(t.order.products_exclusive_tax_value+t.order.products_inclusive_tax_value))))]):"no"===t.options.ns_pos_price_with_tax?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax"))+": "+t._s(t._f("currency")(t.order.total_tax_value)))]):t._e()]:t._e()],2),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[t._v(t._s(t.__("Total")))]),t._v(" "),e("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.order.total)))])])]):t._e(),t._v(" "),"cart"===t.visibleSection?e("table",{staticClass:"table ns-table w-full text-sm"},[e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.selectCustomer()}}},[t._v(t._s(t.__("Customer"))+": "+t._s(t.customerName))])]),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("div",{staticClass:"flex justify-between"},[e("span",[t._v(t._s(t.__("Sub Total")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.subtotal)))])])])]),t._v(" "),t.order.coupons.length>0?e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}}),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.selectCoupon()}}},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),e("td",{staticClass:"border p-2 text-right",attrs:{width:"200"}},[t._v(t._s(t._f("currency")(t.summarizeCoupons())))])]):t._e(),t._v(" "),e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openOrderType()}}},[t._v(t._s(t.__("Type"))+": "+t._s(t.selectedType))])]),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("div",{staticClass:"flex justify-between items-center"},[e("p",[e("span",[t._v(t._s(t.__("Discount")))]),t._v(" "),"percentage"===t.order.discount_type?e("span",[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?e("span",[t._v("("+t._s(t.__("Flat"))+")")]):t._e()]),t._v(" "),e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openDiscountPopup(t.order,"cart")}}},[t._v(t._s(t._f("currency")(t.order.discount)))])])])]),t._v(" "),t.order.type&&"delivery"===t.order.type.identifier?e("tr",[e("td",{staticClass:"border p-2",attrs:{width:"200"}}),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openShippingPopup()}}},[t._v(t._s(t.__("Shipping")))]),t._v(" "),e("span")])]):t._e(),t._v(" "),e("tr",{staticClass:"success"},[e("td",{staticClass:"border p-2",attrs:{width:"200"}},[t.order&&"exclusive"===t.options.ns_pos_tax_type?["yes"===t.options.ns_pos_price_with_tax?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax"))+": "+t._s(t._f("currency")(t.order.total_tax_value)))]):"no"===t.options.ns_pos_price_with_tax?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Inclusive"))+": "+t._s(t._f("currency")(t.order.total_tax_value+t.order.products_exclusive_tax_value)))]):t._e()]:t.order&&"inclusive"===t.options.ns_pos_tax_type?["yes"===t.options.ns_pos_price_with_tax?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Included"))+": "+t._s(t._f("currency")(t.order.total_tax_value)))]):"no"===t.options.ns_pos_price_with_tax?e("a",{staticClass:"cursor-pointer outline-none border-dashed py-1 border-b border-info-primary text-sm",on:{click:function(e){return t.openTaxSummary()}}},[t._v(t._s(t.__("Tax Included"))+": "+t._s(t._f("currency")(t.order.total_tax_value+t.order.products_exclusive_tax_value)))]):t._e()]:t._e()],2),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"200"}},[e("div",{staticClass:"flex justify-between w-full"},[e("span",[t._v(t._s(t.__("Total")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.total)))])])])])]):t._e()]),t._v(" "),e("div",{staticClass:"h-16 flex flex-shrink-0 border-t border-box-edge",attrs:{id:"cart-bottom-buttons"}},[e("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-green-500 text-white hover:bg-green-600 border-r border-green-600 flex-auto",attrs:{id:"pay-button"},on:{click:function(e){return t.payOrder()}}},[e("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-cash-register"}),t._v(" "),e("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[t._v(t._s(t.__("Pay")))])]),t._v(" "),e("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-blue-500 text-white border-r hover:bg-blue-600 border-blue-600 flex-auto",attrs:{id:"hold-button"},on:{click:function(e){return t.holdOrder()}}},[e("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-pause"}),t._v(" "),e("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[t._v(t._s(t.__("Hold")))])]),t._v(" "),e("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-white border-r border-box-edge hover:bg-indigo-100 flex-auto text-gray-700",attrs:{id:"discount-button"},on:{click:function(e){return t.openDiscountPopup(t.order,"cart")}}},[e("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-percent"}),t._v(" "),e("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[t._v(t._s(t.__("Discount")))])]),t._v(" "),e("div",{staticClass:"flex-shrink-0 w-1/4 flex items-center font-bold cursor-pointer justify-center bg-red-500 text-white border-box-edge hover:bg-red-600 flex-auto",attrs:{id:"void-button"},on:{click:function(e){return t.voidOngoingOrder(t.order)}}},[e("i",{staticClass:"mr-2 text-2xl lg:text-xl las la-trash"}),t._v(" "),e("span",{staticClass:"text-lg hidden md:inline lg:text-2xl"},[t._v(t._s(t.__("Void")))])])])])])])}),[],!1,null,null,null).exports},1588:(t,e,r)=>{r.d(e,{Z:()=>et});var n=r(1487),s=r(3515),o=r(2277),i=r(3658),a=r(2867),c=r(8094);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function d(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(Object(r),!0).forEach((function(e){p(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function p(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==u(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===u(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const f={mounted:function(){this.popuCloser(),this.loadFields(),this.product=this.$popupParams.product},data:function(){return{formValidation:new i.Z,fields:[],product:null}},methods:{__:c.__,popuCloser:a.Z,close:function(){this.$popupParams.reject(!1),this.$popup.close()},addProduct:function(){if(this.formValidation.validateFields(this.fields),this.formValidation.fieldsValid(this.fields)){var t=this.formValidation.extractFields(this.fields),e=d(d({},this.product),t);return this.$popupParams.resolve(e),console.log(t,e),this.close()}n.kX.error((0,c.__)("The form is not valid.")).subscribe()},loadFields:function(){var t=this;n.ih.get("/api/nexopos/v4/fields/ns.refund-product").subscribe((function(e){t.fields=t.formValidation.createFields(e),t.fields.forEach((function(e){e.value=t.product[e.name]||""}))}))}}};var v=r(1900);const _=(0,v.Z)(f,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-xl ns-box w-95vw md:w-3/5-screen lg:w-3/7-screen h-95vh md:h-3/5-screen lg:h-3/7-screen overflow-hidden flex flex-col"},[e("div",{staticClass:"p-2 flex justify-between border-b ns-box-header items-center"},[e("h3",{staticClass:"text-semibold"},[t._v(t._s(t.__("Products")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex-auto overflow-y-auto relative ns-scrollbar"},[e("div",{staticClass:"p-2"},t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1),t._v(" "),0===t.fields.length?e("div",{staticClass:"h-full w-full flex items-center justify-center"},[e("ns-spinner")],1):t._e()]),t._v(" "),e("div",{staticClass:"p-2 flex justify-between items-center border-t ns-box-body"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.addProduct()}}},[t._v(t._s(t.__("Add Product")))])],1)])])}),[],!1,null,null,null).exports;var h=r(3216),m=r(8321);const b={components:{nsNumpad:m.Z},data:function(){return{product:null,seeValue:0,availableQuantity:0}},mounted:function(){this.product=this.$popupParams.product,this.availableQuantity=this.$popupParams.availableQuantity,this.seeValue=this.product.quantity},methods:{__:c.__,popupResolver:h.Z,close:function(){this.$popupParams.reject(!1),this.$popup.close()},setChangedValue:function(t){this.seeValue=t},updateQuantity:function(t){if(t>this.availableQuantity)return n.kX.error("Unable to proceed as the quantity provided is exceed the available quantity.").subscribe();this.product.quantity=parseFloat(t),this.$popupParams.resolve(this.product),this.$popup.close()}}};const y=(0,v.Z)(b,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-xl ns-box overflow-hidden w-95vw md:w-4/6-screen lg:w-3/7-screen"},[e("div",{staticClass:"p-2 flex justify-between ns-box-header"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Quantity")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),t.product?e("div",{staticClass:"border-t border-b ns-box-body py-2 flex items-center justify-center text-2xl font-semibold"},[e("span",[t._v(t._s(t.seeValue))]),t._v(" "),e("span",{staticClass:"text-primary text-sm"},[t._v("("+t._s(t.availableQuantity)+" "+t._s(t.__("available"))+")")])]):t._e(),t._v(" "),t.product?e("div",{staticClass:"flex-auto overflow-y-auto p-2"},[e("ns-numpad",{attrs:{value:t.product.quantity},on:{next:function(e){return t.updateQuantity(e)},changed:function(e){return t.setChangedValue(e)}}})],1):t._e()])}),[],!1,null,null,null).exports;var x=r(2909),g=r(2381),w=r(1419),C=r(5494);function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function k(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?k(Object(r),!0).forEach((function(e){j(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function j(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==P(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===P(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const O={components:{nsNumpad:m.Z},props:["order"],computed:{screenValue:function(){var t=parseInt(1+new Array(parseInt(ns.currency.ns_currency_precision)).fill("").map((function(t){return 0})).join(""));return this.screen/t},total:function(){return this.refundables.length>0?this.refundables.map((function(t){return parseFloat(t.unit_price)*parseFloat(t.quantity)})).reduce((function(t,e){return t+e}))+this.shippingFees:0+this.shippingFees},shippingFees:function(){return this.refundShipping?this.order.shipping:0}},data:function(){return{isSubmitting:!1,formValidation:new i.Z,refundables:[],paymentOptions:[],paymentField:[],print:new C.Z({urls:systemUrls,options:systemOptions}),refundShipping:!1,selectedPaymentGateway:!1,screen:0,selectFields:[{type:"select",options:this.order.products.map((function(t){return{label:"".concat(t.name," - ").concat(t.unit.name," (x").concat(t.quantity,")"),value:t.id}})),validation:"required",name:"product_id",label:(0,c.__)("Product"),description:(0,c.__)("Select the product to perform a refund.")}]}},methods:{__:c.__,updateScreen:function(t){this.screen=t},toggleRefundShipping:function(t){this.refundShipping=t,this.refundShipping},proceedPayment:function(){var t=this;return!1===this.selectedPaymentGateway?n.kX.error((0,c.__)("Please select a payment gateway before proceeding.")).subscribe():0===this.total?n.kX.error((0,c.__)("There is nothing to refund.")).subscribe():0===this.screenValue?n.kX.error((0,c.__)("Please provide a valid payment amount.")).subscribe():void w.G.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("The refund will be made on the current order."),onAction:function(e){e&&t.doProceed()}})},doProceed:function(){var t=this,e={products:this.refundables,total:this.screenValue,payment:this.selectedPaymentGateway,refund_shipping:this.refundShipping};this.isSubmitting=!0,n.ih.post("/api/nexopos/v4/orders/".concat(this.order.id,"/refund"),e).subscribe({next:function(e){t.isSubmitting=!1,t.$emit("changed",!0),"refunded"===e.data.order.payment_status&&t.$emit("loadTab","details"),t.print.process(e.data.orderRefund.id,"refund"),n.kX.success(e.message).subscribe()},error:function(e){t.isSubmitting=!1,n.kX.error(e.message).subscribe()}})},addProduct:function(){var t=this;if(this.formValidation.validateFields(this.selectFields),!this.formValidation.fieldsValid(this.selectFields))return n.kX.error((0,c.__)("Please select a product before proceeding.")).subscribe();var e=this.formValidation.extractFields(this.selectFields),r=this.order.products.filter((function(t){return t.id===e.product_id})),s=this.refundables.filter((function(t){return t.id===e.product_id}));if(s.length>0){var o=s.map((function(t){return parseInt(t.quantity)})).reduce((function(t,e){return t+e}));if(o===r[0].quantity)return n.kX.error((0,c.__)("Not enough quantity to proceed.")).subscribe()}if(0===r[0].quantity)return n.kX.error((0,c.__)("Not enough quantity to proceed.")).subscribe();var i=S(S({},r[0]),{condition:"",description:""});new Promise((function(t,e){w.G.show(_,{resolve:t,reject:e,product:i})})).then((function(e){e.quantity=t.getProductOriginalQuantity(e.id)-t.getProductUsedQuantity(e.id),t.refundables.push(e)}),(function(t){return t}))},getProductOriginalQuantity:function(t){var e=this.order.products.filter((function(e){return e.id===t}));return e.length>0?e.map((function(t){return parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0},getProductUsedQuantity:function(t){var e=this.refundables.filter((function(e){return e.id===t}));return e.length>0?e.map((function(t){return parseFloat(t.quantity)})).reduce((function(t,e){return t+e})):0},openSettings:function(t){var e=this;new Promise((function(e,r){w.G.show(_,{resolve:e,reject:r,product:t})})).then((function(r){var n=e.refundables.indexOf(t);e.$set(e.refundables,n,r)}),(function(t){return t}))},selectPaymentGateway:function(){var t=this;new Promise((function(e,r){w.G.show(x.Z,S({resolve:e,reject:r,value:[t.selectedPaymentOption]},t.paymentField[0]))})).then((function(e){t.selectedPaymentGateway=e[0]}),(function(t){return t}))},changeQuantity:function(t){var e=this;new Promise((function(r,n){var s=e.getProductOriginalQuantity(t.id)-e.getProductUsedQuantity(t.id)+parseFloat(t.quantity);w.G.show(y,{resolve:r,reject:n,product:t,availableQuantity:s})})).then((function(r){if(r.quantity>e.getProductUsedQuantity(t.id)-t.quantity){var n=e.refundables.indexOf(t);e.$set(e.refundables,n,r)}}))},deleteProduct:function(t){var e=this;new Promise((function(r,n){w.G.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this product ?"),onAction:function(r){if(r){var n=e.refundables.indexOf(t);e.refundables.splice(n,1)}}})}))}},mounted:function(){var t=this;this.selectFields=this.formValidation.createFields(this.selectFields),n.ih.get("/api/nexopos/v4/orders/payments").subscribe((function(e){t.paymentField=e}))}};const T=(0,v.Z)(O,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"-m-4 flex-auto flex flex-wrap relative"},[t.isSubmitting?e("div",{staticClass:"bg-overlay h-full w-full flex items-center justify-center absolute z-30"},[e("ns-spinner")],1):t._e(),t._v(" "),e("div",{staticClass:"px-4 w-full lg:w-1/2"},[e("h3",{staticClass:"py-2 border-b-2 text-primary border-info-primary"},[t._v(t._s(t.__("Refund With Products")))]),t._v(" "),e("div",{staticClass:"my-2"},[e("ul",[e("li",{staticClass:"border-b border-info-primary flex justify-between items-center mb-2"},[e("div",{staticClass:"flex-auto flex-col flex"},[e("div",{staticClass:"p-2 flex"},t._l(t.selectFields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1),t._v(" "),e("div",{staticClass:"flex justify-between p-2"},[e("div",{staticClass:"flex items-center text-primary"},[t.order.shipping>0?e("span",{staticClass:"mr-2"},[t._v(t._s(t.__("Refund Shipping")))]):t._e(),t._v(" "),t.order.shipping>0?e("ns-checkbox",{attrs:{checked:t.refundShipping},on:{change:function(e){return t.toggleRefundShipping(e)}}}):t._e()],1),t._v(" "),e("div",[e("button",{staticClass:"border rounded-full px-2 py-1 ns-inset-button info",on:{click:function(e){return t.addProduct()}}},[t._v(t._s(t.__("Add Product")))])])])])]),t._v(" "),e("li",[e("h4",{staticClass:"py-1 border-b-2 text-primary border-info-primary"},[t._v(t._s(t.__("Products")))])]),t._v(" "),t._l(t.refundables,(function(r){return e("li",{key:r.id,staticClass:"elevation-surface border flex justify-between items-center mb-2"},[e("div",{staticClass:"px-2 text-primary flex justify-between flex-auto"},[e("div",{staticClass:"flex flex-col"},[e("p",{staticClass:"py-2"},[e("span",[t._v(t._s(r.name))]),t._v(" "),"damaged"===r.condition?e("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-error-tertiary mx-2 text-white"},[t._v(t._s(t.__("Damaged")))]):t._e(),t._v(" "),"unspoiled"===r.condition?e("span",{staticClass:"rounded-full px-2 py-1 text-xs bg-success-tertiary mx-2 text-white"},[t._v(t._s(t.__("Unspoiled")))]):t._e()]),t._v(" "),e("small",[t._v(t._s(r.unit.name))])]),t._v(" "),e("div",{staticClass:"flex items-center justify-center"},[e("span",{staticClass:"py-1 flex items-center cursor-pointer border-b border-dashed border-info-primary"},[t._v(t._s(t._f("currency")(r.unit_price*r.quantity)))])])]),t._v(" "),e("div",{staticClass:"flex"},[e("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(e){return t.openSettings(r)}}},[e("i",{staticClass:"las la-cog text-xl"})]),t._v(" "),e("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(e){return t.deleteProduct(r)}}},[e("i",{staticClass:"las la-trash"})]),t._v(" "),e("p",{staticClass:"p-2 border-l border-info-primary cursor-pointer text-primary ns-numpad-key w-16 h-16 flex items-center justify-center",on:{click:function(e){return t.changeQuantity(r)}}},[t._v(t._s(r.quantity))])])])}))],2)])]),t._v(" "),e("div",{staticClass:"px-4 w-full lg:w-1/2"},[e("h3",{staticClass:"py-2 border-b-2 text-primary border-info-primary"},[t._v(t._s(t.__("Summary")))]),t._v(" "),e("div",{staticClass:"py-2"},[e("div",{staticClass:"elevation-surface border font-semibold flex mb-2 p-2 justify-between"},[e("span",[t._v(t._s(t.__("Total")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.total)))])]),t._v(" "),e("div",{staticClass:"elevation-surface border success font-semibold flex mb-2 p-2 justify-between"},[e("span",[t._v(t._s(t.__("Paid")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])]),t._v(" "),e("div",{staticClass:"elevation-surface border info font-semibold flex mb-2 p-2 justify-between cursor-pointer",on:{click:function(e){return t.selectPaymentGateway()}}},[e("span",[t._v(t._s(t.__("Payment Gateway")))]),t._v(" "),e("span",[t._v(t._s(t.selectedPaymentGateway?t.selectedPaymentGateway.label:"N/A"))])]),t._v(" "),e("div",{staticClass:"elevation-surface border font-semibold flex mb-2 p-2 justify-between"},[e("span",[t._v(t._s(t.__("Screen")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.screenValue)))])]),t._v(" "),e("div",[e("ns-numpad",{attrs:{currency:!0,value:t.screen},on:{changed:function(e){return t.updateScreen(e)},next:function(e){return t.proceedPayment(e)}}})],1)])])])}),[],!1,null,null,null).exports;var L=r(5178);function E(t){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(s=n.key,o=void 0,o=function(t,e){if("object"!==E(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==E(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(s,"string"),"symbol"===E(o)?o:String(o)),n)}var s,o}var $=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n;return e=t,(r=[{key:"getTypeLabel",value:function(t){var e=typeLabels.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}},{key:"getDeliveryStatus",value:function(t){var e=deliveryStatuses.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}},{key:"getProcessingStatus",value:function(t){var e=processingStatuses.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}},{key:"getPaymentStatus",value:function(t){var e=paymentLabels.filter((function(e){return e.value===t}));return e.length>0?e[0].label:(0,c.__)("Unknown Status")}}])&&V(e.prototype,r),n&&V(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function N(t){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N(t)}function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function A(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(Object(r),!0).forEach((function(e){Z(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Z(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==N(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==N(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===N(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const D={props:["order"],data:function(){return{labels:new $,validation:new i.Z,inputValue:0,fields:[],paymentTypes}},computed:{paymentsLabels:function(){var t=new Object;return this.paymentTypes.forEach((function(e){t[e.value]=e.label})),t}},methods:{__:c.__,updateValue:function(t){this.inputValue=t},loadPaymentFields:function(){var t=this;n.ih.get("/api/nexopos/v4/orders/payments").subscribe((function(e){t.fields=t.validation.createFields(e)}))},submitPayment:function(t){var e=this;if(this.validation.validateFields(this.fields),!this.validation.fieldsValid(this.fields))return n.kX.error((0,c.__)("Unable to proceed the form is not valid")).subscribe();if(0==parseFloat(t))return n.kX.error((0,c.__)("Please provide a valid value")).subscribe();t=parseFloat(t);var r=A(A({},this.validation.extractFields(this.fields)),{},{value:t});Popup.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("You make a payment for {amount}. A payment can't be canceled. Would you like to proceed ?").replace("{amount}",this.$options.filters.currency(t)),onAction:function(t){t&&n.ih.post("/api/nexopos/v4/orders/".concat(e.order.id,"/payments"),r).subscribe((function(t){n.kX.success(t.message).subscribe(),e.$emit("changed")}),(function(t){n.kX.error(t.message).subscribe()}))}})}},components:{nsNumpad:m.Z},mounted:function(){this.loadPaymentFields()}};const G=(0,v.Z)(D,(function(){var t=this,e=t._self._c;return e("div",{},[e("div",{staticClass:"flex -mx-4 flex-wrap"},[e("div",{staticClass:"px-2 w-full md:w-1/2"},[e("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface info border text-xl font-bold"},[e("span",[t._v(t._s(t.__("Total")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.total)))])])]),t._v(" "),e("div",{staticClass:"px-2 w-full md:w-1/2"},[e("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface success border text-xl font-bold"},[e("span",[t._v(t._s(t.__("Paid")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.tendered)))])])]),t._v(" "),e("div",{staticClass:"px-2 w-full md:w-1/2"},[e("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface error border text-xl font-bold"},[e("span",[t._v(t._s(t.__("Unpaid")))]),t._v(" "),t.order.total-t.order.tendered>0?e("span",[t._v(t._s(t._f("currency")(t.order.total-t.order.tendered)))]):t._e(),t._v(" "),t.order.total-t.order.tendered<=0?e("span",[t._v(t._s(t._f("currency")(0)))]):t._e()])]),t._v(" "),e("div",{staticClass:"px-2 w-full md:w-1/2"},[e("div",{staticClass:"my-1 h-12 py-1 px-2 flex justify-between items-center elevation-surface warning border text-xl font-bold"},[e("span",[t._v(t._s(t.__("Customer Account")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(t.order.customer.account_amount)))])])])]),t._v(" "),e("div",{staticClass:"flex -mx-4 flex-wrap"},[e("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},["paid"!==t.order.payment_status?e("div",[e("h3",{staticClass:"font-semibold border-b-2 border-info-primary py-2"},[t._v("\n                    "+t._s(t.__("Payment"))+"\n                ")]),t._v(" "),e("div",{staticClass:"py-2"},[t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),t._v(" "),e("div",{staticClass:"my-2 px-2 h-12 flex justify-end items-center border elevation-surface"},[t._v("\n                        "+t._s(t._f("currency")(t.inputValue))+"\n                    ")]),t._v(" "),e("ns-numpad",{attrs:{floating:!0,value:t.inputValue},on:{next:function(e){return t.submitPayment(e)},changed:function(e){return t.updateValue(e)}}})],2)]):t._e(),t._v(" "),"paid"===t.order.payment_status?e("div",{staticClass:"flex items-center justify-center h-full"},[e("h3",{staticClass:"text-primary font-semibold"},[t._v(t._s(t.__("No payment possible for paid order.")))])]):t._e()]),t._v(" "),e("div",{staticClass:"px-2 w-full mb-4 md:w-1/2"},[e("h3",{staticClass:"font-semibold border-b-2 border-info-primary py-2 mb-2"},[t._v("\n                "+t._s(t.__("Payment History"))+"\n            ")]),t._v(" "),e("ul",t._l(t.order.payments,(function(r){return e("li",{key:r.id,staticClass:"p-2 flex items-center justify-between text-shite border elevation-surface mb-2"},[e("span",[t._v(t._s(t.paymentsLabels[r.identifier]||t.__("Unknown")))]),t._v(" "),e("span",[t._v(t._s(t._f("currency")(r.value)))])])})),0)])])])}),[],!1,null,null,null).exports;var I=r(9527);const R={props:["order"],data:function(){return{processingStatuses,deliveryStatuses,labels:new $,showProcessingSelect:!1,showDeliverySelect:!1}},mounted:function(){},methods:{__:c.__,submitProcessingChange:function(){var t=this;w.G.show(g.default,{title:(0,c.__)("Would you proceed ?"),message:(0,c.__)("The processing status of the order will be changed. Please confirm your action."),onAction:function(e){e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/processing"),{process_status:t.order.process_status}).subscribe({next:function(e){t.showProcessingSelect=!1,n.kX.success(e.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("Unexpected error occurred.")).subscribe()}})}})},openRefunds:function(){var t=this;try{new Promise((function(e,r){var n=t.order;w.G.show(I.Z,{order:n,resolve:e,reject:r})}))}catch(t){}},submitDeliveryStatus:function(){var t=this;w.G.show(g.default,{title:(0,c.__)("Would you proceed ?"),message:(0,c.__)("The delivery status of the order will be changed. Please confirm your action."),onAction:function(e){e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/delivery"),{delivery_status:t.order.delivery_status}).subscribe({next:function(e){t.showDeliverySelect=!1,n.kX.success(e.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("Unexpected error occurred.")).subscribe()}})}})}}};const q=(0,v.Z)(R,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"-mx-4 flex flex-wrap"},[e("div",{staticClass:"flex-auto"},[e("div",{staticClass:"w-full mb-2 flex-wrap flex"},[e("div",{staticClass:"w-full mb-2 px-4"},[e("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Payment Summary")))])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"elevation-surface border p-2 flex justify-between items-start"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(t.__("Sub Total")))])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(t.order.subtotal)))])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start ns-notice error"},[e("div",[e("h4",{staticClass:"text-semibold"},[e("span",{staticClass:"text-white"},[t._v(t._s(t.__("Discount")))]),t._v(" "),"percentage"===t.order.discount_type?e("span",{staticClass:"text-white ml-1"},[t._v("("+t._s(t.order.discount_percentage)+"%)")]):t._e(),t._v(" "),"flat"===t.order.discount_type?e("span",{staticClass:"text-white ml-1"},[t._v("(Flat)")]):t._e()])]),t._v(" "),e("div",{staticClass:"font-semibold"},[e("span",[t._v(t._s(t._f("currency")(t.order.discount)))])])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(t.__("Shipping")))])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(t.order.shipping)))])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start ns-notice error"},[e("div",[e("h4",{staticClass:"text-semibold"},[t._v("\n                            "+t._s(t.__("Coupons"))+"\n                        ")])]),t._v(" "),e("div",{staticClass:"font-semibold"},[e("span",[t._v(t._s(t._f("currency")(t.order.total_coupons)))])])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start ns-notice info"},[e("div",[e("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Total")))])]),t._v(" "),e("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.total)))])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start ns-notice warning"},[e("div",[e("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Taxes")))])]),t._v(" "),e("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.tax_value)))])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start text-primary elevation-surface error border"},[e("div",[e("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Change")))])]),t._v(" "),e("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.change)))])])]),t._v(" "),e("div",{staticClass:"mb-2 w-full md:w-1/2 px-4"},[e("div",{staticClass:"p-2 flex justify-between items-start elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold"},[t._v(t._s(t.__("Paid")))])]),t._v(" "),e("div",{staticClass:"font-semibold"},[t._v(t._s(t._f("currency")(t.order.tendered)))])])])])]),t._v(" "),e("div",{staticClass:"px-4 w-full md:w-1/2 lg:w-2/4 mb-2"},[e("div",{staticClass:"mb-2"},[e("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Order Status")))])]),t._v(" "),e("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[e("span",[t._v(t._s(t.__("Customer")))])])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t.order.nexopos_customers_name))])]),t._v(" "),e("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[e("span",[t._v(t._s(t.__("Type")))])])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t.labels.getTypeLabel(t.order.type)))])]),t._v(" "),e("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[e("span",[t._v(t._s(t.__("Delivery Status")))])])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary mt-2 md:mt-0 w-full md:w-auto"},[e("div",{staticClass:"w-full text-center"},[t.showDeliverySelect?t._e():e("span",{staticClass:"font-semibold text-secondary border-b border-info-primary cursor-pointer border-dashed",on:{click:function(e){t.showDeliverySelect=!0}}},[t._v(t._s(t.labels.getDeliveryStatus(t.order.delivery_status)))])]),t._v(" "),t.showDeliverySelect?e("div",{staticClass:"flex-auto flex"},[e("div",{staticClass:"ns-select flex items-center justify-center"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.order.delivery_status,expression:"order.delivery_status"}],ref:"process_status",staticClass:"flex-auto border-info-primary rounded-lg",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.order,"delivery_status",e.target.multiple?r:r[0])}}},t._l(t.deliveryStatuses,(function(r,n){return e("option",{key:n,domProps:{value:r.value}},[t._v(t._s(r.label))])})),0)]),t._v(" "),e("div",{staticClass:"pl-2 flex"},[e("ns-close-button",{on:{click:function(e){t.showDeliverySelect=!1}}}),t._v(" "),e("button",{staticClass:"bg-success-primary text-white rounded-full px-2 py-1",on:{click:function(e){return t.submitDeliveryStatus(t.order)}}},[t._v(t._s(t.__("Save")))])],1)]):t._e()])]),t._v(" "),e("div",{staticClass:"mb-2 p-2 flex flex-col md:flex-row justify-between items-center elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[e("span",[t._v(t._s(t.__("Processing Status")))])])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary mt-2 md:mt-0 w-full md:w-auto"},[e("div",{staticClass:"w-full text-center"},[t.showProcessingSelect?t._e():e("span",{staticClass:"border-b border-info-primary cursor-pointer border-dashed",on:{click:function(e){t.showProcessingSelect=!0}}},[t._v(t._s(t.labels.getProcessingStatus(t.order.process_status)))])]),t._v(" "),t.showProcessingSelect?e("div",{staticClass:"flex-auto flex"},[e("div",{staticClass:"ns-select flex items-center justify-center"},[e("select",{directives:[{name:"model",rawName:"v-model",value:t.order.process_status,expression:"order.process_status"}],ref:"process_status",staticClass:"flex-auto border-info-primary rounded-lg",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.order,"process_status",e.target.multiple?r:r[0])}}},t._l(t.processingStatuses,(function(r,n){return e("option",{key:n,domProps:{value:r.value}},[t._v(t._s(r.label))])})),0)]),t._v(" "),e("div",{staticClass:"pl-2 flex"},[e("ns-close-button",{on:{click:function(e){t.showProcessingSelect=!1}}}),t._v(" "),e("button",{staticClass:"bg-success-primary text-white rounded-full px-2 py-1",on:{click:function(e){return t.submitProcessingChange(t.order)}}},[t._v(t._s(t.__("Save")))])],1)]):t._e()])]),t._v(" "),e("div",{staticClass:"mb-2 p-2 flex justify-between items-start elevation-surface border"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[e("span",[t._v(t._s(t.__("Payment Status")))])])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t.labels.getPaymentStatus(t.order.payment_status)))])])]),t._v(" "),e("div",{staticClass:"px-4 w-full md:w-1/2 lg:w-2/4 mb-2"},[e("div",{staticClass:"mb-2"},[e("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Products")))])]),t._v(" "),t._l(t.order.products,(function(r){return e("div",{key:r.id,staticClass:"p-2 flex justify-between items-start elevation-surface border mb-6"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(r.name)+" (x"+t._s(r.quantity)+")")]),t._v(" "),e("p",{staticClass:"text-secondary text-sm"},[t._v(t._s(r.unit.name||"N/A"))])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(r.total_price)))])])})),t._v(" "),e("div",{staticClass:"mb-2"},[e("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary flex justify-between"},[e("span",[t._v(t._s(t.__("Refunded Products")))]),t._v(" "),e("a",{staticClass:"border-b border-info-primary border-dashed",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.openRefunds()}}},[t._v(t._s(t.__("All Refunds")))])])]),t._v(" "),t._l(t.order.refunded_products,(function(r,n){return e("div",{key:n,staticClass:"p-2 flex justify-between items-start elevation-surface border mb-6"},[e("div",[e("h4",{staticClass:"text-semibold text-primary"},[t._v(t._s(r.order_product.name)+" (x"+t._s(r.quantity)+")")]),t._v(" "),e("p",{staticClass:"text-secondary text-sm"},[t._v(t._s(r.unit.name||"N/A")+" | "),e("span",{staticClass:"rounded-full px-2",class:"damaged"===r.condition?"bg-error-tertiary text-white":"bg-info-tertiary text-white"},[t._v(t._s(r.condition))])])]),t._v(" "),e("div",{staticClass:"font-semibold text-secondary"},[t._v(t._s(t._f("currency")(r.total_price)))])])}))],2)])}),[],!1,null,null,null).exports;function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function H(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Q(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==X(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===X(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const U={name:"ns-order-instalments-payment",components:{nsNotice:r(9634).nsNotice},data:function(){return{paymentTypes,fields:[{type:"select",name:"payment_type",description:(0,c.__)("Select the payment type that must apply to the current order."),label:(0,c.__)("Payment Type"),validation:"required",options:paymentTypes}],print:new C.Z({urls:systemUrls,options:systemOptions}),validation:new i.Z,order:null,instalment:null}},methods:{__:c.__,popupResolver:h.Z,popupCloser:a.Z,close:function(){this.popupResolver(!1)},updateInstalmentAsDue:function(t){var e=this;nsHttpClient.put("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments/").concat(this.instalment.id,"/"),{instalment:{date:ns.date.moment.format("YYYY-MM-DD HH:mm:ss")}}).subscribe({next:function(t){e.submitPayment()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})},submitPayment:function(){var t=this;if(!this.validation.validateFields(this.fields))return n.kX.error(__m("The form is not valid.")).subcribe();nsHttpClient.post("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments/").concat(this.instalment.id,"/pay"),function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?H(Object(r),!0).forEach((function(e){Q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):H(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},this.validation.extractFields(this.fields))).subscribe({next:function(e){t.popupResolver(!0),t.print.exec(e.data.payment.id,"payment"),n.kX.success(e.message).subscribe()},error:function(e){"failed"===e.status&&Popup.show(g.default,{title:(0,c.__)("Update Instalment Date"),message:(0,c.__)("Would you like to mark that instalment as due today ? If you confirm the instalment will be marked as paid."),onAction:function(e){e&&t.updateInstalmentAsDue(t.instalment)}}),n.kX.error(e.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}},mounted:function(){this.popupCloser(),this.order=this.$popupParams.order,this.instalment=this.$popupParams.instalment,this.fields=this.validation.createFields(this.fields)}};const Y=(0,v.Z)(U,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg ns-box w-95vw md:w-2/3-screen lg:w-1/3-screen"},[e("div",{staticClass:"p-2 flex justify-between border-b items-center"},[e("h3",[t._v(t._s(t.__("Payment Method")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"p-2 ns-box-body"},[e("ns-notice",{staticClass:"py-2 p-4 text-center border text-primary rounded-lg",attrs:{color:"info"}},[t._v(t._s(t.__("Before submitting the payment, choose the payment type used for that order.")))]),t._v(" "),e("br"),t._v(" "),t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})}))],2),t._v(" "),e("div",{staticClass:"border-t ns-box-footer p-2 flex justify-end"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.submitPayment()}}},[t._v(t._s(t.__("Submit Payment")))])],1)])}),[],!1,null,null,null).exports;function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function M(){M=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,i=Object.create(o.prototype),a=new L(n||[]);return s(i,"_invoke",{value:S(t,r,a)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",v="executing",_="completed",h={};function m(){}function b(){}function y(){}var x={};u(x,i,(function(){return this}));var g=Object.getPrototypeOf,w=g&&g(g(E([])));w&&w!==r&&n.call(w,i)&&(x=w);var C=y.prototype=m.prototype=Object.create(x);function P(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function r(s,o,i,a){var c=d(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==W(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,a)}),(function(t){r("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){r(t,n,e,s)}))}return o=o?o.then(s,s):s()}})}function S(e,r,n){var s=p;return function(o,i){if(s===v)throw new Error("Generator is already running");if(s===_){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=j(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===p)throw s=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=v;var u=d(e,r,n);if("normal"===u.type){if(s=n.done?_:f,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(s=_,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,s=e.iterator[n];if(s===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=d(s,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function E(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(W(e)+" is not iterable")}return b.prototype=y,s(C,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},P(k.prototype),u(k.prototype,a,(function(){return this})),e.AsyncIterator=k,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new k(l(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},P(C),u(C,c,"Generator"),u(C,i,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=E,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;T(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:E(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}function z(t,e,r,n,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}const B={props:["order"],name:"ns-order-instalments",data:function(){return{labels:new $,original:[],instalments:[],print:new C.Z({urls:systemUrls,options:systemOptions,type:"payment"})}},mounted:function(){this.loadInstalments()},computed:{totalInstalments:function(){return this.instalments.length>0?this.instalments.map((function(t){return t.amount})).reduce((function(t,e){return parseFloat(t)+parseFloat(e)})):0}},methods:{__:c.__,loadInstalments:function(){var t=this;n.ih.get("/api/nexopos/v4/orders/".concat(this.order.id,"/instalments")).subscribe((function(e){t.original=e,t.instalments=e.map((function(t){return t.price_clicked=!1,t.date_clicked=!1,t.date=moment(t.date).format("YYYY-MM-DD"),t}))}))},showReceipt:function(t){if(null===t.payment_id)return n.kX.error((0,c.__)("This instalment doesn't have any payment attached.")).subscribe();this.print.process(t.payment_id,"payment")},addInstalment:function(){this.instalments.push({date:ns.date.moment.format("YYYY-MM-DD"),amount:this.order.total-this.totalInstalments,paid:!1})},createInstalment:function(t){var e=this;Popup.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to create this instalment ?"),onAction:function(r){r&&n.ih.post("/api/nexopos/v4/orders/".concat(e.order.id,"/instalments"),{instalment:t}).subscribe({next:function(t){e.loadInstalments(),n.kX.success(t.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}})},deleteInstalment:function(t){var e=this;Popup.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this instalment ?"),onAction:function(r){r&&n.ih.delete("/api/nexopos/v4/orders/".concat(e.order.id,"/instalments/").concat(t.id)).subscribe({next:function(r){var s=e.instalments.indexOf(t);e.instalments.splice(s,1),n.kX.success(r.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}})},markAsPaid:function(t){var e,r=this;return(e=M().mark((function e(){return M().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,n){Popup.show(Y,{order:r.order,instalment:t,resolve:e,reject:n})}));case 3:e.sent,r.loadInstalments(),e.next=9;break;case 7:e.prev=7,e.t0=e.catch(0);case 9:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function i(t){z(o,n,s,i,a,"next",t)}function a(t){z(o,n,s,i,a,"throw",t)}i(void 0)}))})()},togglePriceEdition:function(t){var e=this;t.paid||(t.price_clicked=!t.price_clicked,this.$forceUpdate(),t.price_clicked&&setTimeout((function(){e.$refs.amount[0].select()}),100))},updateInstalment:function(t){var e=this;Popup.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to update that instalment ?"),onAction:function(r){r&&n.ih.put("/api/nexopos/v4/orders/".concat(e.order.id,"/instalments/").concat(t.id),{instalment:t}).subscribe({next:function(t){n.kX.success(t.message).subscribe()},error:function(t){n.kX.error(t.message||(0,c.__)("An unexpected error has occurred")).subscribe()}})}})},toggleDateEdition:function(t){var e=this;t.paid||(t.date_clicked=!t.date_clicked,this.$forceUpdate(),t.date_clicked&&setTimeout((function(){e.$refs.date[0].select()}),200))}}};const J=(0,v.Z)(B,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"-mx-4 flex-auto flex flex-wrap"},[e("div",{staticClass:"flex flex-auto"},[e("div",{staticClass:"w-full mb-2 flex-wrap"},[e("div",{staticClass:"w-full mb-2 px-4"},[e("h3",{staticClass:"font-semibold text-secondary pb-2 border-b border-info-primary"},[t._v(t._s(t.__("Instalments")))])]),t._v(" "),e("div",{staticClass:"px-4"},[e("ul",{staticClass:"border-table-th-edge border-t text-primary"},[t._l(t.instalments,(function(r){return e("li",{key:r.id,staticClass:"border-b border-l flex justify-between elevation-surface",class:r.paid?"success":"info"},[e("span",{staticClass:"p-2"},[r.date_clicked?t._e():e("span",{on:{click:function(e){return t.toggleDateEdition(r)}}},[t._v(t._s(r.date))]),t._v(" "),r.date_clicked?e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:r.date,expression:"instalment.date"}],ref:"date",refInFor:!0,staticClass:"border border-info-primary rounded",attrs:{type:"date"},domProps:{value:r.date},on:{blur:function(e){return t.toggleDateEdition(r)},input:function(e){e.target.composing||t.$set(r,"date",e.target.value)}}})]):t._e()]),t._v(" "),e("div",{staticClass:"flex items-center"},[e("div",{staticClass:"flex items-center px-2 h-full border-r"},[r.price_clicked?t._e():e("span",{on:{click:function(e){return t.togglePriceEdition(r)}}},[t._v(t._s(t._f("currency")(r.amount)))]),t._v(" "),r.price_clicked?e("span",[e("input",{directives:[{name:"model",rawName:"v-model",value:r.amount,expression:"instalment.amount"}],ref:"amount",refInFor:!0,staticClass:"border border-info-primary p-1",attrs:{type:"text"},domProps:{value:r.amount},on:{blur:function(e){return t.togglePriceEdition(r)},input:function(e){e.target.composing||t.$set(r,"amount",e.target.value)}}})]):t._e()]),t._v(" "),!r.paid&&r.id?e("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full border-r"},[e("div",{staticClass:"px-2"},[e("ns-icon-button",{attrs:{type:"success",className:"la-money-bill-wave-alt"},on:{click:function(e){return t.markAsPaid(r)}}})],1),t._v(" "),e("div",{staticClass:"px-2"},[e("ns-icon-button",{attrs:{type:"info",className:"la-save"},on:{click:function(e){return t.updateInstalment(r)}}})],1),t._v(" "),e("div",{staticClass:"px-2"},[e("ns-icon-button",{attrs:{type:"error",className:"la-trash-alt"},on:{click:function(e){return t.deleteInstalment(r)}}})],1)]):t._e(),t._v(" "),r.paid||r.id?t._e():e("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full border-r"},[e("div",{staticClass:"px-2"},[e("div",{staticClass:"ns-button info"},[e("button",{staticClass:"px-3 py-1 rounded-full",on:{click:function(e){return t.createInstalment(r)}}},[e("i",{staticClass:"las la-plus"}),t._v("\n                                            "+t._s(t.__("Create"))+"\n                                        ")])])])]),t._v(" "),r.paid?e("div",{staticClass:"w-36 justify-center flex items-center px-2 h-full"},[e("div",{staticClass:"ns-button info"},[e("button",{staticClass:"px-3 text-xs py-1 rounded-full",on:{click:function(e){return t.showReceipt(r)}}},[e("i",{staticClass:"las la-print"}),t._v("\n                                        "+t._s(t.__("Receipt"))+"\n                                    ")])])]):t._e()])])})),t._v(" "),e("li",{staticClass:"flex justify-between p-2 border-r border-b border-l elevation-surface"},[e("div",{staticClass:"flex items-center justify-center"},[e("span",[t._v("\n                                "+t._s(t.__("Total :"))+" "+t._s(t._f("currency")(t.order.total))+"\n                            ")]),t._v(" "),e("span",{staticClass:"ml-1 text-sm"},[t._v("\n                                ("+t._s(t.__("Remaining :"))+" "+t._s(t._f("currency")(t.order.total-t.totalInstalments))+")\n                            ")])]),t._v(" "),e("div",{staticClass:"-mx-2 flex flex-wrap items-center"},[e("span",{staticClass:"px-2"},[t._v("\n                                "+t._s(t.__("Instalments:"))+" "+t._s(t._f("currency")(t.totalInstalments))+"\n                            ")]),t._v(" "),e("span",{staticClass:"px-2"},[e("div",{staticClass:"ns-button info"},[e("button",{staticClass:"rounded-full px-3 py-1",on:{click:function(e){return t.addInstalment()}}},[t._v(t._s(t.__("Add Instalment")))])])])])])],2)])])])])}),[],!1,null,null,null).exports;var K={filters:{nsCurrency:s.W},name:"ns-preview-popup",data:function(){return{active:"details",order:new Object,products:[],payments:[],options:null,print:new C.Z({urls:systemUrls,options:systemOptions}),settings:null}},components:{nsOrderRefund:T,nsOrderPayment:G,nsOrderDetails:q,nsOrderInstalments:J},computed:{isVoidable:function(){return["paid","partially_paid","unpaid"].includes(this.order.payment_status)},isDeleteAble:function(){return["hold"].includes(this.order.payment_status)}},methods:{__:c.__,popupResolver:h.Z,popupCloser:a.Z,closePopup:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.popupResolver(t)},setActive:function(t){this.active=t},printOrder:function(){this.print.process(this.order.id,"sale")},refresh:function(){this.$popupParams.component.$emit("updated"),this.loadOrderDetails(this.order.id)},loadOrderDetails:function(t){var e=this;(0,o.D)([n.ih.get("/api/nexopos/v4/orders/".concat(t)),n.ih.get("/api/nexopos/v4/orders/".concat(t,"/products")),n.ih.get("/api/nexopos/v4/orders/".concat(t,"/payments"))]).subscribe((function(t){e.order=t[0],e.products=t[1],e.payments=t[2]}))},deleteOrder:function(){var t=this;Popup.show(g.default,{title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("Would you like to delete this order"),onAction:function(e){e&&n.ih.delete("/api/nexopos/v4/orders/".concat(t.order.id)).subscribe({next:function(e){n.kX.success(e.message).subscribe(),t.refreshCrudTable(),t.closePopup(!0)},error:function(t){n.kX.error(t.message).subscribe()}})}})},voidOrder:function(){var t=this;try{new Promise((function(e,r){Popup.show(L.default,{resolve:e,reject:r,title:(0,c.__)("Confirm Your Action"),message:(0,c.__)("The current order will be void. This action will be recorded. Consider providing a reason for this operation"),onAction:function(e){!1!==e&&n.ih.post("/api/nexopos/v4/orders/".concat(t.order.id,"/void"),{reason:e}).subscribe({next:function(e){n.kX.success(e.message).subscribe(),t.refreshCrudTable(),t.closePopup(!0)},error:function(t){n.kX.error(t.message).subscribe()}})}})}))}catch(t){console.log(t)}},refreshCrudTable:function(){this.$popupParams.component.$emit("updated",!0)}},watch:{active:function(){"details"===this.active&&this.loadOrderDetails(this.order.id)}},mounted:function(){this.order=this.$popupParams.order,this.options=systemOptions,this.urls=systemUrls,this.loadOrderDetails(this.order.id),this.popupCloser()}};window.nsOrderPreviewPopup=K;const tt=K;const et=(0,v.Z)(tt,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"h-95vh w-95vw md:h-6/7-screen md:w-6/7-screen overflow-hidden shadow-xl ns-box flex flex-col"},[e("div",{staticClass:"border-b ns-box-header p-3 flex items-center justify-between"},[e("div",[e("h3",[t._v(t._s(t.__("Order Options")))])]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup(!0)}}})],1)]),t._v(" "),e("div",{staticClass:"p-2 overflow-scroll ns-box-body flex flex-auto"},[t.order.id?e("ns-tabs",{attrs:{active:t.active},on:{active:function(e){return t.setActive(e)}}},[e("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:t.__("Details"),identifier:"details"}},[e("ns-order-details",{attrs:{order:t.order}})],1),t._v(" "),["order_void","hold","refunded","partially_refunded"].includes(t.order.payment_status)?t._e():e("ns-tabs-item",{staticClass:"overflow-y-auto",attrs:{label:t.__("Payments"),identifier:"payments"}},[e("ns-order-payment",{attrs:{order:t.order},on:{changed:function(e){return t.refresh()}}})],1),t._v(" "),["order_void","hold","refunded"].includes(t.order.payment_status)?t._e():e("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:t.__("Refund & Return"),identifier:"refund"}},[e("ns-order-refund",{attrs:{order:t.order},on:{loadTab:function(e){return t.setActive(e)},changed:function(e){return t.refresh()}}})],1),t._v(" "),["partially_paid","unpaid"].includes(t.order.payment_status)&&t.order.support_instalments?e("ns-tabs-item",{staticClass:"flex overflow-y-auto",attrs:{label:t.__("Installments"),identifier:"instalments"}},[e("ns-order-instalments",{attrs:{order:t.order},on:{changed:function(e){return t.refresh()}}})],1):t._e()],1):t._e(),t._v(" "),t.order.id?t._e():e("div",{staticClass:"h-full w-full flex items-center justify-center"},[e("ns-spinner")],1)],1),t._v(" "),e("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[e("div",[t.isVoidable?e("ns-button",{attrs:{type:"error"},on:{click:function(e){return t.voidOrder()}}},[e("i",{staticClass:"las la-ban"}),t._v("\n                "+t._s(t.__("Void"))+"\n            ")]):t._e(),t._v(" "),t.isDeleteAble?e("ns-button",{attrs:{type:"error"},on:{click:function(e){return t.deleteOrder()}}},[e("i",{staticClass:"las la-trash"}),t._v("\n                "+t._s(t.__("Delete"))+"\n            ")]):t._e()],1),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.printOrder()}}},[e("i",{staticClass:"las la-print"}),t._v("\n                "+t._s(t.__("Print"))+"\n            ")])],1)])])}),[],!1,null,null,null).exports},9527:(t,e,r)=>{r.d(e,{Z:()=>u});var n=r(8094),s=r(2867),o=r(3216),i=r(1487),a=r(5494);const c={name:"ns-orders-refund-popup",data:function(){return{order:null,refunds:[],view:"summary",previewed:null,loaded:!1,options:systemOptions,systemUrls,print:new a.Z({urls:systemUrls,options:systemOptions})}},methods:{__:n.__,popupCloser:s.Z,popupResolver:o.Z,toggleProductView:function(t){this.view="details",this.previewed=t},loadOrderRefunds:function(){var t=this;nsHttpClient.get("/api/nexopos/v4/orders/".concat(this.order.id,"/refunds")).subscribe((function(e){t.loaded=!0,t.refunds=e.refunds}),(function(t){i.kX.error(t.message).subscribe()}))},close:function(){this.$popup.close()},printRefundReceipt:function(t){this.print.process(t.id,"refund")}},mounted:function(){this.order=this.$popupParams.order,this.popupCloser(),this.loadOrderRefunds()}};const u=(0,r(1900).Z)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg w-95vw h-95vh md:w-3/5-screen md:h-3/5-screen ns-box flex flex-col overflow-hidden"},[e("div",{staticClass:"border-b p-2 flex items-center justify-between ns-box-header"},[e("h3",[t._v(t._s(t.__("Order Refunds")))]),t._v(" "),e("div",{staticClass:"flex"},["details"===t.view?e("div",{staticClass:"flex items-center justify-center cursor-pointer rounded-full px-3 border hover:bg-info-primary hover:text-white mr-1",on:{click:function(e){t.view="summary"}}},[t._v(t._s(t.__("Go Back")))]):t._e(),t._v(" "),e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"overflow-auto flex-auto ns-box-body"},["summary"===t.view?[t.loaded?t._e():e("div",{staticClass:"flex h-full w-full items-center justify-center"},[e("ns-spinner",{attrs:{size:"24"}})],1),t._v(" "),t.loaded&&0===t.refunds.length?e("div",{staticClass:"flex h-full w-full items-center justify-center"},[e("i",{staticClass:"lar la-frown-open"})]):t._e(),t._v(" "),t.loaded&&t.refunds.length>0?t._l(t.refunds,(function(r){return e("div",{key:r.id,staticClass:"border-b flex flex-col md:flex-row"},[e("div",{staticClass:"w-full md:flex-auto p-2"},[e("h3",{staticClass:"font-semibold mb-1"},[t._v(t._s(t.order.code))]),t._v(" "),e("div",[e("ul",{staticClass:"flex -mx-1 text-sm text-primary"},[e("li",{staticClass:"px-1"},[t._v(t._s(t.__("Total"))+" : "+t._s(t._f("currency")(r.total)))]),t._v(" "),e("li",{staticClass:"px-1"},[t._v(t._s(t.__("By"))+" : "+t._s(r.author.username))])])])]),t._v(" "),e("div",{staticClass:"w-full md:w-16 cursor-pointer hover:bg-info-primary hover:border-info-primary hover:text-white text-lg flex items-center justify-center md:border-l",on:{click:function(e){return t.toggleProductView(r)}}},[e("i",{staticClass:"las la-eye"})]),t._v(" "),e("div",{staticClass:"w-full md:w-16 cursor-pointer hover:bg-info-primary hover:border-info-primary hover:text-white text-lg flex items-center justify-center md:border-l",on:{click:function(e){return t.printRefundReceipt(r)}}},[e("i",{staticClass:"las la-print"})])])})):t._e()]:t._e(),t._v(" "),"details"===t.view?t._l(t.previewed.refunded_products,(function(r){return e("div",{key:r.id,staticClass:"border-b flex flex-col md:flex-row"},[e("div",{staticClass:"w-full md:flex-auto p-2"},[e("h3",{staticClass:"font-semibold mb-1"},[t._v(t._s(r.product.name))]),t._v(" "),e("div",[e("ul",{staticClass:"flex -mx-1 text-sm text-primary"},[e("li",{staticClass:"px-1"},[t._v(t._s(t.__("Condition"))+" : "+t._s(r.condition))]),t._v(" "),e("li",{staticClass:"px-1"},[t._v(t._s(t.__("Quantity"))+" : "+t._s(r.quantity))]),t._v(" "),e("li",{staticClass:"px-1"},[t._v(t._s(t.__("Total"))+" : "+t._s(t._f("currency")(r.total_price)))])])])])])})):t._e()],2)])}),[],!1,null,null,null).exports},4527:(t,e,r)=>{r.d(e,{Z:()=>u});var n=r(2867),s=r(3216),o=r(1487),i=r(8094),a=r(5627);r(2357);const c={name:"ns-pos-coupons-load-popup",components:{nsNotice:r(1128).Z},data:function(){return{placeHolder:(0,i.__)("Coupon Code"),couponCode:null,order:null,activeTab:"apply-coupon",orderSubscriber:null,customerCoupon:null}},mounted:function(){var t=this;this.popupCloser(),this.$refs.coupon.select(),this.orderSubscriber=POS.order.subscribe((function(e){t.order=e,t.order.coupons.length>0&&(t.activeTab="active-coupons")})),this.$popupParams&&this.$popupParams.apply_coupon&&(this.couponCode=this.$popupParams.apply_coupon,this.getCoupon(this.couponCode).subscribe({next:function(e){t.customerCoupon=e,t.apply()}}))},destroyed:function(){this.orderSubscriber.unsubscribe()},methods:{__:i.__,popupCloser:n.Z,popupResolver:s.Z,selectCustomer:function(){Popup.show(a.Z)},cancel:function(){this.customerCoupon=null,this.couponCode=null},removeCoupon:function(t){this.order.coupons.splice(t,1),POS.refreshCart()},apply:function(){var t=this;try{var e=this.customerCoupon;if(null!==this.customerCoupon.coupon.valid_hours_start&&!ns.date.moment.isAfter(this.customerCoupon.coupon.valid_hours_start)&&this.customerCoupon.coupon.valid_hours_start.length>0)return o.kX.error((0,i.__)("The coupon is out from validity date range.")).subscribe();if(null!==this.customerCoupon.coupon.valid_hours_end&&!ns.date.moment.isBefore(this.customerCoupon.coupon.valid_hours_end)&&this.customerCoupon.coupon.valid_hours_end.length>0)return o.kX.error((0,i.__)("The coupon is out from validity date range.")).subscribe();var r=this.customerCoupon.coupon.products;if(r.length>0){var n=r.map((function(t){return t.product_id}));if(0===this.order.products.filter((function(t){return n.includes(t.product_id)})).length)return o.kX.error((0,i.__)("This coupon requires products that aren't available on the cart at the moment.")).subscribe()}var s=this.customerCoupon.coupon.categories;if(s.length>0){var a=s.map((function(t){return t.category_id}));if(0===this.order.products.filter((function(t){return a.includes(t.$original().category_id)})).length)return o.kX.error((0,i.__)("This coupon requires products that belongs to specific categories that aren't included at the moment.").replace("%s")).subscribe()}this.cancel();var c={active:e.coupon.active,customer_coupon_id:e.id,minimum_cart_value:e.coupon.minimum_cart_value,maximum_cart_value:e.coupon.maximum_cart_value,name:e.coupon.name,type:e.coupon.type,value:0,limit_usage:e.coupon.limit_usage,code:e.coupon.code,discount_value:e.coupon.discount_value,categories:e.coupon.categories,products:e.coupon.products};POS.pushCoupon(c),this.activeTab="active-coupons",setTimeout((function(){t.popupResolver(c)}),500),o.kX.success((0,i.__)("The coupon has applied to the cart.")).subscribe()}catch(t){console.log(t)}},getCouponType:function(t){switch(t){case"percentage_discount":return(0,i.__)("Percentage");case"flat_discount":return(0,i.__)("Flat");default:return(0,i.__)("Unknown Type")}},getDiscountValue:function(t){switch(t.type){case"percentage_discount":return t.discount_value+"%";case"flat_discount":return this.$options.filters.currency(t.discount_value)}},closePopup:function(){this.popupResolver(!1)},setActiveTab:function(t){this.activeTab=t},getCoupon:function(t){return!this.order.customer_id>0?o.kX.error((0,i.__)("You must select a customer before applying a coupon.")).subscribe():o.ih.post("/api/nexopos/v4/customers/coupons/".concat(t),{customer_id:this.order.customer_id})},loadCoupon:function(){var t=this,e=this.couponCode;this.getCoupon(e).subscribe({next:function(e){t.customerCoupon=e,o.kX.success((0,i.__)("The coupon has been loaded.")).subscribe()},error:function(t){o.kX.error(t.message||(0,i.__)("An unexpected error occurred.")).subscribe()}})}}};const u=(0,r(1900).Z)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg ns-box w-95vw md:w-3/6-screen lg:w-2/6-screen"},[e("div",{staticClass:"border-b ns-box-header p-2 flex justify-between items-center"},[e("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Load Coupon")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"p-1 ns-box-body"},[e("ns-tabs",{attrs:{active:t.activeTab},on:{changeTab:function(e){return t.setActiveTab(e)}}},[e("ns-tabs-item",{attrs:{label:t.__("Apply A Coupon"),padding:"p-2",identifier:"apply-coupon"}},[e("div",{staticClass:"border-2 input-group info rounded flex"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.couponCode,expression:"couponCode"}],ref:"coupon",staticClass:"w-full text-primary p-2 outline-none",attrs:{type:"text",placeholder:t.placeHolder},domProps:{value:t.couponCode},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.loadCoupon()},input:function(e){e.target.composing||(t.couponCode=e.target.value)}}}),t._v(" "),e("button",{staticClass:"px-3 py-2",on:{click:function(e){return t.loadCoupon()}}},[t._v(t._s(t.__("Load")))])]),t._v(" "),e("div",{staticClass:"pt-2"},[e("ns-notice",{attrs:{color:"info"},scopedSlots:t._u([{key:"description",fn:function(){return[t._v(t._s(t.__("Input the coupon code that should apply to the POS. If a coupon is issued for a customer, that customer must be selected priorly.")))]},proxy:!0}])})],1),t._v(" "),t.order&&void 0===t.order.customer_id?e("div",{staticClass:"pt-2 flex"},[e("button",{staticClass:"w-full border p-2 outline-none ns-numpad-key info cursor-pointer text-center",on:{click:function(e){return t.selectCustomer()}}},[t._v(t._s(t.__("Click here to choose a customer.")))])]):t._e(),t._v(" "),t.order&&void 0!==t.order.customer_id?e("div",{staticClass:"pt-2"},[e("ns-notice",{attrs:{color:"success"},scopedSlots:t._u([{key:"description",fn:function(){return[t._v(t._s(t.__("Loading Coupon For : ")+"".concat(t.order.customer.name," ").concat(t.order.customer.surname)))]},proxy:!0}],null,!1,2531213351)})],1):t._e(),t._v(" "),e("div",{staticClass:"overflow-hidden"},[t.customerCoupon?e("div",{staticClass:"pt-2 fade-in-entrance anim-duration-500 overflow-y-auto ns-scrollbar h-64"},[e("table",{staticClass:"w-full ns-table"},[e("tbody",[e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Coupon Name")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.name))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Discount"))+" ("+t._s(t.getCouponType(t.customerCoupon.coupon.type))+")")]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.getDiscountValue(t.customerCoupon.coupon)))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Usage")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.usage+"/"+(t.customerCoupon.limit_usage||t.__("Unlimited"))))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Valid From")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.coupon.valid_hours_start||t.__("N/A")))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Valid Till")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.customerCoupon.coupon.valid_hours_end||t.__("N/A")))])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Categories")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[e("ul",[t._l(t.customerCoupon.coupon.categories,(function(r){return e("li",{key:r.id,staticClass:"rounded-full px-3 py-1 border"},[t._v(t._s(r.category.name))])})),t._v(" "),0===t.customerCoupon.coupon.categories.length?e("li",[t._v(t._s(t.__("Not applicable")))]):t._e()],2)])]),t._v(" "),e("tr",[e("td",{staticClass:"p-2 w-1/2 border"},[t._v(t._s(t.__("Products")))]),t._v(" "),e("td",{staticClass:"p-2 w-1/2 border"},[e("ul",[t._l(t.customerCoupon.coupon.products,(function(r){return e("li",{key:r.id,staticClass:"rounded-full px-3 py-1 border"},[t._v(t._s(r.product.name))])})),t._v(" "),0===t.customerCoupon.coupon.products.length?e("li",[t._v(t._s(t.__("Not applicable")))]):t._e()],2)])])])])]):t._e()])]),t._v(" "),e("ns-tabs-item",{attrs:{label:t.__("Active Coupons"),padding:"p-1",identifier:"active-coupons"}},[t.order?e("ul",[t._l(t.order.coupons,(function(r,n){return e("li",{key:n,staticClass:"flex justify-between elevation-surface border items-center px-2 py-1"},[e("div",{staticClass:"flex-auto"},[e("h3",{staticClass:"font-semibold text-primary p-2 flex justify-between"},[e("span",[t._v(t._s(r.name))]),t._v(" "),e("span",[t._v(t._s(t.getDiscountValue(r)))])])]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.removeCoupon(n)}}})],1)])})),t._v(" "),0===t.order.coupons.length?e("li",{staticClass:"flex justify-between elevation-surface border items-center p-2"},[t._v("\n                        "+t._s(t.__("No coupons applies to the cart."))+"\n                    ")]):t._e()],2):t._e()])],1)],1),t._v(" "),t.customerCoupon?e("div",{staticClass:"flex"},[e("button",{staticClass:"w-1/2 px-3 py-2 bg-success-tertiary text-white font-bold",on:{click:function(e){return t.apply()}}},[t._v("\n            "+t._s(t.__("Apply"))+"\n        ")]),t._v(" "),e("button",{staticClass:"w-1/2 px-3 py-2 bg-error-tertiary text-white font-bold",on:{click:function(e){return t.cancel()}}},[t._v("\n            "+t._s(t.__("Cancel"))+"\n        ")])]):t._e()])}),[],!1,null,null,null).exports},5627:(t,e,r)=>{r.d(e,{Z:()=>c});var n=r(1487),s=r(3216),o=r(1419),i=r(6121);const a={data:function(){return{searchCustomerValue:"",orderSubscription:null,order:{},debounceSearch:null,customers:[],isLoading:!1}},computed:{customerSelected:function(){return!1}},watch:{searchCustomerValue:function(t){var e=this;clearTimeout(this.debounceSearch),this.debounceSearch=setTimeout((function(){e.searchCustomer(t)}),500)}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(e){t.order=e})),this.getRecentCustomers(),this.$refs.searchField.focus()},destroyed:function(){this.orderSubscription.unsubscribe()},methods:{__:r(8094).__,resolveIfQueued:s.Z,attemptToChoose:function(){if(1===this.customers.length)return this.selectCustomer(this.customers[0]);n.kX.info("Too many result.").subscribe()},openCustomerHistory:function(t,e){e.stopImmediatePropagation(),this.$popup.close(),o.G.show(i.Z,{customer:t,activeTab:"account-payment"})},selectCustomer:function(t){var e=this;this.customers.forEach((function(t){return t.selected=!1})),t.selected=!0,this.isLoading=!0,POS.selectCustomer(t).then((function(r){e.isLoading=!1,e.resolveIfQueued(t)})).catch((function(t){e.isLoading=!1}))},searchCustomer:function(t){var e=this;n.ih.post("/api/nexopos/v4/customers/search",{search:t}).subscribe((function(t){t.forEach((function(t){return t.selected=!1})),e.customers=t}))},createCustomerWithMatch:function(t){this.resolveIfQueued(!1),o.G.show(i.Z,{name:t})},getRecentCustomers:function(){var t=this;this.isLoading=!0,n.ih.get("/api/nexopos/v4/customers/recently-active").subscribe({next:function(e){t.isLoading=!1,e.forEach((function(t){return t.selected=!1})),t.customers=e},error:function(e){t.isLoading=!1}})}}};const c=(0,r(1900).Z)(a,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box shadow-xl w-4/5-screen md:w-2/5-screen xl:w-108",attrs:{id:"ns-pos-customer-select-popup"}},[e("div",{staticClass:"border-b ns-box-header text-center font-semibold text-2xl py-2",attrs:{id:"header"}},[e("h2",[t._v(t._s(t.__("Select Customer")))])]),t._v(" "),e("div",{staticClass:"relative"},[e("div",{staticClass:"p-2 border-b ns-box-body items-center flex justify-between"},[e("span",[t._v(t._s(t.__("Selected"))+" : ")]),t._v(" "),e("div",{staticClass:"flex items-center justify-between"},[e("span",[t._v(t._s(t.order.customer?t.order.customer.name:"N/A"))]),t._v(" "),t.order.customer?e("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button hover:border-transparent",on:{click:function(e){return t.openCustomerHistory(t.order.customer,e)}}},[e("i",{staticClass:"las la-eye"})]):t._e()])]),t._v(" "),e("div",{staticClass:"p-2 border-b ns-box-body flex justify-between text-primary"},[e("div",{staticClass:"input-group flex-auto border-2 rounded"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchCustomerValue,expression:"searchCustomerValue"}],ref:"searchField",staticClass:"outline-none w-full p-2",attrs:{placeholder:"Search Customer",type:"text"},domProps:{value:t.searchCustomerValue},on:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.attemptToChoose()},input:function(e){e.target.composing||(t.searchCustomerValue=e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"h-3/5-screen xl:h-2/5-screen overflow-y-auto ns-scrollbar"},[e("ul",{staticClass:"ns-vertical-menu"},[t.customers&&0===t.customers.length?e("li",{staticClass:"p-2 text-center text-primary"},[t._v("\n                    "+t._s(t.__("No customer match your query..."))+"\n                ")]):t._e(),t._v(" "),t.customers&&0===t.customers.length?e("li",{staticClass:"p-2 cursor-pointer text-center text-primary",on:{click:function(e){return t.createCustomerWithMatch(t.searchCustomerValue)}}},[e("span",{staticClass:"border-b border-dashed border-info-primary"},[t._v(t._s(t.__("Create a customer")))])]):t._e(),t._v(" "),t._l(t.customers,(function(r){return e("li",{key:r.id,staticClass:"cursor-pointer p-2 border-b text-primary flex justify-between items-center",on:{click:function(e){return t.selectCustomer(r)}}},[e("span",[t._v(t._s(r.name))]),t._v(" "),e("p",{staticClass:"flex items-center"},[r.owe_amount>0?e("span",{staticClass:"text-error-primary"},[t._v("-"+t._s(t._f("currency")(r.owe_amount)))]):t._e(),t._v(" "),r.owe_amount>0?e("span",[t._v("/")]):t._e(),t._v(" "),e("span",{staticClass:"purchase-amount"},[t._v(t._s(t._f("currency")(r.purchases_amount)))]),t._v(" "),e("button",{staticClass:"mx-2 rounded-full h-8 w-8 flex items-center justify-center border ns-inset-button info",on:{click:function(e){return t.openCustomerHistory(r,e)}}},[e("i",{staticClass:"las la-eye"})])])])}))],2)]),t._v(" "),t.isLoading?e("div",{staticClass:"z-10 top-0 absolute w-full h-full flex items-center justify-center"},[e("ns-spinner",{attrs:{size:"24",border:"8"}})],1):t._e()])])}),[],!1,null,null,null).exports},6121:(t,e,r)=>{r.d(e,{Z:()=>g});var n=r(2867),s=r(1487),o=r(1419),i=r(5627),a=r(3658),c=r(8094);const u={mounted:function(){this.closeWithOverlayClicked(),this.loadTransactionFields()},data:function(){return{fields:[],isSubmiting:!1,formValidation:new a.Z}},methods:{__:c.__,closeWithOverlayClicked:n.Z,proceed:function(){var t=this,e=this.$popupParams.customer,r=this.formValidation.extractFields(this.fields);this.isSubmiting=!0,s.ih.post("/api/nexopos/v4/customers/".concat(e.id,"/account-history"),r).subscribe({next:function(e){t.isSubmiting=!1,s.kX.success(e.message).subscribe(),t.$popupParams.resolve(e),t.$popup.close()},error:function(e){t.isSubmiting=!1,s.kX.error(e.message).subscribe(),t.$popupParams.reject(e)}})},close:function(){this.$popup.close(),this.$popupParams.reject(!1)},loadTransactionFields:function(){var t=this;s.ih.get("/api/nexopos/v4/fields/ns.customers-account").subscribe({next:function(e){t.fields=t.formValidation.createFields(e)}})}}};var l=r(1900);const d=(0,l.Z)(u,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-6/7-screen md:w-5/7-screen lg:w-4/7-screen h-6/7-screen md:h-5/7-screen lg:h-5/7-screen overflow-hidden shadow-lg ns-box flex flex-col relative"},[e("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[e("h2",{staticClass:"font-semibold"},[t._v(t._s(t.__("New Transaction")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex-auto overflow-y-auto"},[0===t.fields.length?e("div",{staticClass:"h-full w-full flex items-center justify-center"},[e("ns-spinner")],1):t._e(),t._v(" "),t.fields.length>0?e("div",{staticClass:"p-2"},t._l(t.fields,(function(t,r){return e("ns-field",{key:r,attrs:{field:t}})})),1):t._e()]),t._v(" "),e("div",{staticClass:"p-2 ns-box-footer justify-between border-t flex"},[e("div"),t._v(" "),e("div",{staticClass:"px-1"},[e("div",{staticClass:"-mx-2 flex flex-wrap"},[e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"error"},on:{click:function(e){return t.close()}}},[t._v(t._s(t.__("Close")))])],1),t._v(" "),e("div",{staticClass:"px-1"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.proceed()}}},[t._v(t._s(t.__("Proceed")))])],1)])])]),t._v(" "),0===t.isSubmiting?e("div",{staticClass:"h-full w-full absolute flex items-center justify-center",staticStyle:{background:"rgb(0 98 171 / 45%)"}},[e("ns-spinner")],1):t._e()])}),[],!1,null,null,null).exports;var p=r(4527),f=r(2381),v=r(3216),_=r(5507),h=r(1588);function m(t){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},m(t)}function b(){b=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),a=new V(n||[]);return s(i,"_invoke",{value:O(t,r,a)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",f="suspendedYield",v="executing",_="completed",h={};function y(){}function x(){}function g(){}var w={};u(w,i,(function(){return this}));var C=Object.getPrototypeOf,P=C&&C(C($([])));P&&P!==r&&n.call(P,i)&&(w=P);var k=g.prototype=y.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(s,o,i,a){var c=d(t[s],t,o);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==m(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,i,a)}),(function(t){r("throw",t,i,a)})):e.resolve(l).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,a)}))}a(c.arg)}var o;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){r(t,n,e,s)}))}return o=o?o.then(s,s):s()}})}function O(e,r,n){var s=p;return function(o,i){if(s===v)throw new Error("Generator is already running");if(s===_){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=T(a,n);if(c){if(c===h)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===p)throw s=_,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=v;var u=d(e,r,n);if("normal"===u.type){if(s=n.done?_:f,u.arg===h)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(s=_,n.method="throw",n.arg=u.arg)}}}function T(e,r){var n=r.method,s=e.iterator[n];if(s===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var o=d(s,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,h;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,h):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function V(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function $(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(m(e)+" is not iterable")}return x.prototype=g,s(k,"constructor",{value:g,configurable:!0}),s(g,"constructor",{value:x,configurable:!0}),x.displayName=u(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,u(t,c,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(j.prototype),u(j.prototype,a,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new j(l(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(k),u(k,c,"Generator"),u(k,i,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=$,V.prototype={constructor:V,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,h):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),h},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),E(r),h}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;E(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:$(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),h}},e}function y(t,e,r,n,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}const x={name:"ns-pos-customers",data:function(){return{activeTab:"create-customers",customer:null,subscription:null,orders:[],options:{},optionsSubscriber:null,selectedTab:"orders",isLoadingCoupons:!1,isLoadingRewards:!1,isLoadingHistory:!1,isLoadingOrders:!1,coupons:[],rewardsResponse:[],order:null,walletHistories:[]}},components:{nsPaginate:_.Z},destroyed:function(){this.subscription.unsubscribe(),this.optionsSubscriber.unsubscribe()},mounted:function(){var t=this;this.closeWithOverlayClicked(),this.optionsSubscriber=POS.options.subscribe((function(e){t.options=e})),this.subscription=POS.order.subscribe((function(e){t.order=e,void 0!==t.$popupParams.customer?(t.activeTab="account-payment",t.customer=t.$popupParams.customer,t.loadCustomerOrders()):void 0!==e.customer&&(t.activeTab="account-payment",t.customer=e.customer,t.loadCustomerOrders())})),this.popupCloser()},methods:{__:c.__,reload:function(){this.loadCustomerOrders()},popupResolver:v.Z,popupCloser:n.Z,getWalletHistoryLabel:function(t){switch(t){case"add":return(0,c.__)("Crediting");case"deduct":return(0,c.__)("Removing");case"refund":return(0,c.__)("Refunding");case"payment":return(0,c.__)("Payment");default:return(0,c.__)("Unknow")}},getType:function(t){switch(t){case"percentage_discount":return(0,c.__)("Percentage Discount");case"flat_discount":return(0,c.__)("Flat Discount")}},closeWithOverlayClicked:n.Z,openOrderOptions:function(t){var e,r=this;return(e=b().mark((function e(){return b().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new Promise((function(e,r){o.G.show(h.Z,{order:t,resolve:e,reject:r})}));case 3:e.sent,r.reload(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),s.kX.error((0,c.__)("An error occurred while opening the order options")).subscribe();case 10:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function i(t){y(o,n,s,i,a,"next",t)}function a(t){y(o,n,s,i,a,"throw",t)}i(void 0)}))})()},doChangeTab:function(t){this.selectedTab=t,"coupons"===t&&this.loadCoupons(),"rewards"===t&&this.loadRewards(),"wallet-history"===t&&this.loadAccounHistory(),"orders"===t&&this.loadCustomerOrders()},loadAccounHistory:function(){var t=this;this.isLoadingHistory=!0,s.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/account-history")).subscribe({next:function(e){t.walletHistories=e.data,t.isLoadingHistory=!1},error:function(e){t.isLoadingHistory=!1}})},loadCoupons:function(){var t=this;this.isLoadingCoupons=!0,s.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/coupons")).subscribe({next:function(e){t.coupons=e,t.isLoadingCoupons=!1},error:function(e){t.isLoadingCoupons=!1}})},loadRewards:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/api/nexopos/v4/customers/".concat(this.customer.id,"/rewards");this.isLoadingRewards=!0,s.ih.get(e).subscribe({next:function(e){t.rewardsResponse=e,t.isLoadingRewards=!1},error:function(e){t.isLoadingRewards=!1}})},prefillForm:function(t){void 0!==this.$popupParams.name&&(t.main.value=this.$popupParams.name)},openCustomerSelection:function(){this.$popup.close(),o.G.show(i.Z)},loadCustomerOrders:function(){var t=this;this.isLoadingOrders=!0,s.ih.get("/api/nexopos/v4/customers/".concat(this.customer.id,"/orders")).subscribe({next:function(e){t.orders=e,t.isLoadingOrders=!1},error:function(e){t.isLoadingOrders=!1}})},newTransaction:function(t){new Promise((function(e,r){o.G.show(d,{customer:t,resolve:e,reject:r})})).then((function(e){POS.loadCustomer(t.id).subscribe((function(t){POS.selectCustomer(t)}))}))},applyCoupon:function(t){var e=this;void 0===this.order.customer?o.G.show(f.default,{title:(0,c.__)("Use Customer ?"),message:(0,c.__)("No customer is selected. Would you like to proceed with this customer ?"),onAction:function(r){r&&POS.selectCustomer(e.customer).then((function(r){e.proceedApplyingCoupon(t)}))}}):this.order.customer.id===this.customer.id?this.proceedApplyingCoupon(t):this.order.customer.id!==this.customer.id&&o.G.show(f.default,{title:(0,c.__)("Change Customer ?"),message:(0,c.__)("Would you like to assign this customer to the ongoing order ?"),onAction:function(r){r&&POS.selectCustomer(e.customer).then((function(r){e.proceedApplyingCoupon(t)}))}})},proceedApplyingCoupon:function(t){var e=this;new Promise((function(e,r){o.G.show(p.Z,{apply_coupon:t.code,resolve:e,reject:r})})).then((function(t){e.popupResolver(!1)})).catch((function(t){}))},handleSavedCustomer:function(t){s.kX.success(t.message).subscribe(),POS.selectCustomer(t.entry),this.$popup.close()}}};const g=(0,l.Z)(x,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-lg rounded w-95vw h-95vh lg:w-3/5-screen flex flex-col overflow-hidden",attrs:{id:"ns-pos-customers"}},[e("div",{staticClass:"ns-header p-2 flex justify-between items-center border-b"},[e("h3",{staticClass:"font-semibold"},[t._v(t._s(t.__("Customers")))]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.$popup.close()}}})],1)]),t._v(" "),e("div",{staticClass:"ns-body flex-auto flex p-2 overflow-y-auto"},[e("ns-tabs",{attrs:{active:t.activeTab},on:{active:function(e){t.activeTab=e}}},[e("ns-tabs-item",{attrs:{identifier:"create-customers",label:"New Customer"}},["yes"===t.options.ns_pos_customers_creation_enabled?e("ns-crud-form",{attrs:{"submit-url":"/api/nexopos/v4/crud/ns.customers",src:"/api/nexopos/v4/crud/ns.customers/form-config"},on:{updated:function(e){return t.prefillForm(e)},save:function(e){return t.handleSavedCustomer(e)}},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.__("Customer Name")))]},proxy:!0},{key:"save",fn:function(){return[t._v(t._s(t.__("Save Customer")))]},proxy:!0}],null,!1,2432171054)}):t._e(),t._v(" "),"yes"!==t.options.ns_pos_customers_creation_enabled?e("div",{staticClass:"h-full flex-col w-full flex items-center justify-center text-primary"},[e("i",{staticClass:"lar la-hand-paper ns-icon text-6xl"}),t._v(" "),e("h3",{staticClass:"font-medium text-2xl"},[t._v(t._s(t.__("Not Authorized")))]),t._v(" "),e("p",[t._v(t._s(t.__("Creating customers has been explicitly disabled from the settings.")))])]):t._e()],1),t._v(" "),e("ns-tabs-item",{staticClass:"flex",staticStyle:{padding:"0!important"},attrs:{identifier:"account-payment",label:t.__("Customer Account")}},[null===t.customer?e("div",{staticClass:"flex-auto w-full flex items-center justify-center flex-col p-4"},[e("i",{staticClass:"lar la-frown text-6xl"}),t._v(" "),e("h3",{staticClass:"font-medium text-2xl"},[t._v(t._s(t.__("No Customer Selected")))]),t._v(" "),e("p",[t._v(t._s(t.__("In order to see a customer account, you need to select one customer.")))]),t._v(" "),e("div",{staticClass:"my-2"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.openCustomerSelection()}}},[t._v(t._s(t.__("Select Customer")))])],1)]):t._e(),t._v(" "),t.customer?e("div",{staticClass:"flex flex-col flex-auto"},[e("div",{staticClass:"flex-auto p-2 flex flex-col"},[e("div",{staticClass:"-mx-4 flex flex-wrap ns-tab-cards"},[e("div",{staticClass:"px-4 mb-4 w-full"},[e("h2",{staticClass:"font-semibold"},[t._v(t._s(t.__("Summary For"))+" : "+t._s(t.customer.name))])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-success-secondary to-green-700 p-2 flex flex-col text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Total Purchases")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"font-bold"},[t._v(t._s(t._f("currency")(t.customer.purchases_amount)))])])])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-error-secondary to-red-700 p-2 text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Total Owed")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.owed_amount)))])])])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-blue-500 to-blue-700 p-2 text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Wallet Amount")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.account_amount)))])])])]),t._v(" "),e("div",{staticClass:"px-4 mb-4 w-full md:w-1/4"},[e("div",{staticClass:"rounded-lg shadow bg-transparent bg-gradient-to-br from-teal-500 to-teal-700 p-2 text-white"},[e("h3",{staticClass:"font-medium text-lg"},[t._v(t._s(t.__("Credit Limit")))]),t._v(" "),e("div",{staticClass:"w-full flex justify-end"},[e("h2",{staticClass:"text-2xl font-bold"},[t._v(t._s(t._f("currency")(t.customer.credit_limit_amount)))])])])])]),t._v(" "),e("div",{staticClass:"flex flex-auto flex-col overflow-hidden"},[e("ns-tabs",{attrs:{active:t.selectedTab},on:{changeTab:function(e){return t.doChangeTab(e)}}},[e("ns-tabs-item",{attrs:{identifier:"orders",label:t.__("Orders")}},[t.isLoadingOrders?e("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[e("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingOrders?t._e():[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Last Purchases")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table ns-table w-full"},[e("thead",[e("tr",{staticClass:"text-primary"},[e("th",{staticClass:"p-2 border font-semibold",attrs:{colspan:"3",width:"150"}},[t._v(t._s(t.__("Order")))]),t._v(" "),e("th",{staticClass:"p-2 border font-semibold",attrs:{width:"50"}},[t._v(t._s(t.__("Options")))])])]),t._v(" "),e("tbody",{staticClass:"text-primary"},[0===t.orders.length?e("tr",[e("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No orders...")))])]):t._e(),t._v(" "),t._l(t.orders,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border p-2 text-center",attrs:{colspan:"3"}},[e("div",{staticClass:"flex flex-col items-start"},[e("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Code"))+": "+t._s(r.code))]),t._v(" "),e("div",{staticClass:"md:-mx-2 w-full flex flex-col md:flex-row"},[e("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/4"},[e("small",[t._v(t._s(t.__("Total"))+": "+t._s(t._f("currency")(r.total)))])]),t._v(" "),e("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/4"},[e("small",[t._v(t._s(t.__("Status"))+": "+t._s(r.human_status))])]),t._v(" "),e("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/4"},[e("small",[t._v(t._s(t.__("Delivery"))+": "+t._s(r.human_delivery_status))])])])])]),t._v(" "),e("td",{staticClass:"border p-2 text-center"},[e("button",{staticClass:"rounded-full h-8 px-2 flex items-center justify-center border border-gray ns-inset-button success",on:{click:function(e){return t.openOrderOptions(r)}}},[e("i",{staticClass:"las la-wallet"}),t._v(" "),e("span",{staticClass:"ml-1"},[t._v(t._s(t.__("Options")))])])])])}))],2)])])])]],2),t._v(" "),e("ns-tabs-item",{attrs:{identifier:"wallet-history",label:t.__("Wallet History")}},[t.isLoadingHistory?e("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[e("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingHistory?t._e():[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Wallet History")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table ns-table w-full"},[e("thead",[e("tr",{staticClass:"text-primary"},[e("th",{staticClass:"p-2 border font-semibold",attrs:{colspan:"3",width:"150"}},[t._v(t._s(t.__("Transaction")))])])]),t._v(" "),e("tbody",{staticClass:"text-primary"},[0===t.walletHistories.length?e("tr",[e("td",{staticClass:"border p-2 text-center",attrs:{colspan:"3"}},[t._v(t._s(t.__("No History...")))])]):t._e(),t._v(" "),t._l(t.walletHistories,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border p-2 text-center",attrs:{colspan:"3"}},[e("div",{staticClass:"flex flex-col items-start"},[e("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Transaction"))+": "+t._s(t.getWalletHistoryLabel(r.operation)))]),t._v(" "),e("div",{staticClass:"md:-mx-2 w-full flex flex-col md:flex-row"},[e("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/3"},[e("small",[t._v(t._s(t.__("Amount"))+": "+t._s(t._f("currency")(r.amount)))])]),t._v(" "),e("div",{staticClass:"md:px-2 flex items-start w-full md:w-1/3"},[e("small",[t._v(t._s(t.__("Date"))+": "+t._s(r.created_at))])])])])])])}))],2)])])])]],2),t._v(" "),e("ns-tabs-item",{attrs:{identifier:"coupons",label:t.__("Coupons")}},[t.isLoadingCoupons?e("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[e("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingCoupons?t._e():[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Coupons")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table ns-table w-full"},[e("thead",[e("tr",{staticClass:"text-primary"},[e("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Name")))]),t._v(" "),e("th",{staticClass:"p-2 border font-semibold"},[t._v(t._s(t.__("Type")))]),t._v(" "),e("th",{staticClass:"p-2 border font-semibold"})])]),t._v(" "),e("tbody",{staticClass:"text-primary text-sm"},[0===t.coupons.length?e("tr",[e("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No coupons for the selected customer...")))])]):t._e(),t._v(" "),t._l(t.coupons,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border p-2",attrs:{width:"300"}},[e("h3",[t._v(t._s(r.name))]),t._v(" "),e("div",{},[e("ul",{staticClass:"-mx-2 flex"},[e("li",{staticClass:"text-xs text-primary px-2"},[t._v(t._s(t.__("Usage :"))+" "+t._s(r.usage)+"/"+t._s(r.limit_usage))]),t._v(" "),e("li",{staticClass:"text-xs text-primary px-2"},[t._v(t._s(t.__("Code :"))+" "+t._s(r.code))])])])]),t._v(" "),e("td",{staticClass:"border p-2 text-center"},[t._v(t._s(t.getType(r.coupon.type))+"\n                                                                "),"percentage_discount"===r.coupon.type?e("span",[t._v("\n                                                                    ("+t._s(r.coupon.discount_value)+"%)\n                                                                ")]):t._e(),t._v(" "),"flat_discount"===r.coupon.type?e("span",[t._v("\n                                                                    ("+t._s(t._f("currency")(r.coupon.discount_value))+")\n                                                                ")]):t._e()]),t._v(" "),e("td",{staticClass:"border p-2 text-right"},[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.applyCoupon(r)}}},[t._v(t._s(t.__("Use Coupon")))])],1)])}))],2)])])])]],2),t._v(" "),e("ns-tabs-item",{attrs:{identifier:"rewards",label:t.__("Rewards")}},[t.isLoadingRewards?e("div",{staticClass:"flex-auto h-full justify-center flex items-center"},[e("ns-spinner",{attrs:{size:"36"}})],1):t._e(),t._v(" "),t.isLoadingRewards?t._e():[e("div",{staticClass:"py-2 w-full"},[e("h2",{staticClass:"font-semibold text-primary"},[t._v(t._s(t.__("Rewards")))])]),t._v(" "),e("div",{staticClass:"flex-auto flex-col flex overflow-hidden"},[e("div",{staticClass:"flex-auto overflow-y-auto"},[e("table",{staticClass:"table ns-table w-full"},[e("thead",[e("tr",{staticClass:"text-primary"},[e("th",{staticClass:"p-2 border font-semibold",attrs:{width:"150"}},[t._v(t._s(t.__("Name")))]),t._v(" "),e("th",{staticClass:"p-2 border font-semibold"},[t._v(t._s(t.__("Points")))]),t._v(" "),e("th",{staticClass:"p-2 border font-semibold"},[t._v(t._s(t.__("Target")))])])]),t._v(" "),t.rewardsResponse.data?e("tbody",{staticClass:"text-primary text-sm"},[0===t.rewardsResponse.data.length?e("tr",[e("td",{staticClass:"border p-2 text-center",attrs:{colspan:"4"}},[t._v(t._s(t.__("No rewards available the selected customer...")))])]):t._e(),t._v(" "),t._l(t.rewardsResponse.data,(function(r){return e("tr",{key:r.id},[e("td",{staticClass:"border p-2",attrs:{width:"300"}},[e("h3",{staticClass:"text-center"},[t._v(t._s(r.reward_name))])]),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"300"}},[e("h3",{staticClass:"text-center"},[t._v(t._s(r.points))])]),t._v(" "),e("td",{staticClass:"border p-2",attrs:{width:"300"}},[e("h3",{staticClass:"text-center"},[t._v(t._s(r.target))])])])}))],2):t._e()])])]),t._v(" "),e("div",{staticClass:"py-1 flex justify-end"},[e("ns-paginate",{attrs:{pagination:t.rewardsResponse},on:{load:function(e){return t.loadRewards(e)}}})],1)]],2)],1)],1)]),t._v(" "),e("div",{staticClass:"p-2 border-t border-box-edge flex justify-between"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.newTransaction(t.customer)}}},[t._v(t._s(t.__("Account Transaction")))])],1)])]):t._e()])],1)],1)])}),[],!1,null,null,null).exports},4140:(t,e,r)=>{r.r(e),r.d(e,{default:()=>s});const n={name:"ns-pos-loading-popup"};const s=(0,r(1900).Z)(n,(function(){return(0,this._self._c)("ns-spinner")}),[],!1,null,null,null).exports},1951:(t,e,r)=>{r.d(e,{Z:()=>l});var n=r(3216),s=r(8094),o=r(2867);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){a=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",u=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,r){return t[e]=r}}function p(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),a=new V(n||[]);return s(i,"_invoke",{value:O(t,r,a)}),i}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var v="suspendedStart",_="suspendedYield",h="executing",m="completed",b={};function y(){}function x(){}function g(){}var w={};d(w,c,(function(){return this}));var C=Object.getPrototypeOf,P=C&&C(C($([])));P&&P!==r&&n.call(P,c)&&(w=P);var k=g.prototype=y.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(s,o,a,c){var u=f(t[s],t,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==i(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(d).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var o;s(this,"_invoke",{value:function(t,n){function s(){return new e((function(e,s){r(t,n,e,s)}))}return o=o?o.then(s,s):s()}})}function O(e,r,n){var s=v;return function(o,i){if(s===h)throw new Error("Generator is already running");if(s===m){if("throw"===o)throw i;return{value:t,done:!0}}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=T(a,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(s===v)throw s=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);s=h;var u=f(e,r,n);if("normal"===u.type){if(s=n.done?m:_,u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(s=m,n.method="throw",n.arg=u.arg)}}}function T(e,r){var n=r.method,s=e.iterator[n];if(s===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,T(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var o=f(s,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,b;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,b):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,b)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function V(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function $(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var s=-1,o=function r(){for(;++s<e.length;)if(n.call(e,s))return r.value=e[s],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(i(e)+" is not iterable")}return x.prototype=g,s(k,"constructor",{value:g,configurable:!0}),s(g,"constructor",{value:x,configurable:!0}),x.displayName=d(g,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===x||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,d(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(j.prototype),d(j.prototype,u,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,s,o){void 0===o&&(o=Promise);var i=new j(p(t,r,n,s),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},S(k),d(k,l,"Generator"),d(k,c,(function(){return this})),d(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=$,V.prototype={constructor:V,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function s(n,s){return a.type="throw",a.arg=e,r.next=n,s&&(r.method="next",r.arg=t),!!s}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return s("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return s(i.catchLoc,!0);if(this.prev<i.finallyLoc)return s(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return s(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return s(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var s=this.tryEntries[r];if(s.tryLoc<=this.prev&&n.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var o=s;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),E(r),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var s=n.arg;E(r)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:$(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),b}},e}function c(t,e,r,n,s,o,i){try{var a=t[o](i),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,s)}const u={data:function(){return{types:[],typeSubscription:null}},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.typeSubscription=POS.types.subscribe((function(e){t.types=e,1===Object.values(t.types).length&&t.select(Object.keys(t.types)[0])})),this.popupCloser()},destroyed:function(){this.typeSubscription.unsubscribe()},methods:{__:s.__,popupCloser:o.Z,popupResolver:n.Z,resolveIfQueued:n.Z,select:function(t){var e,r=this;return(e=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object.values(r.types).forEach((function(t){return t.selected=!1})),r.types[t].selected=!0,n=r.types[t],e.prev=3,e.next=6,POS.triggerOrderTypeSelection(n);case 6:e.sent,POS.types.next(r.types),r.resolveIfQueued(n),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(3);case 13:case"end":return e.stop()}}),e,null,[[3,11]])})),function(){var t=this,r=arguments;return new Promise((function(n,s){var o=e.apply(t,r);function i(t){c(o,n,s,i,a,"next",t)}function a(t){c(o,n,s,i,a,"throw",t)}i(void 0)}))})()}}};const l=(0,r(1900).Z)(u,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"h-full w-4/5-screen md:w-2/5-screen lg:w-2/5-screen xl:w-2/6-screen shadow-lg",attrs:{id:"ns-order-type"}},[e("div",{staticClass:"h-16 flex justify-center items-center",attrs:{id:"header"}},[e("h3",{staticClass:"font-bold"},[t._v(t._s(t.__("Define The Order Type")))])]),t._v(" "),0===Object.values(t.types).length?e("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-1 grid-rows-1"},[e("div",{staticClass:"h-full w-full flex items-center justify-center flex-col"},[e("i",{staticClass:"las la-frown text-7xl"}),t._v(" "),e("div",{staticClass:"p-4 md:w-2/3"},[e("p",{staticClass:"text-center"},[t._v(t._s(t.__("No payment type has been selected on the settings. Please check your POS features and choose the supported order type")))]),t._v(" "),e("div",{staticClass:"flex justify-center py-1"},[e("ns-link",{attrs:{target:"_blank",type:"info",href:"https://my.nexopos.com/en/documentation/components/order-types"}},[t._v(t._s(t.__("Read More")))])],1)])])]):t._e(),t._v(" "),Object.values(t.types).length>0?e("div",{staticClass:"ns-box-body grid grid-flow-row grid-cols-2 grid-rows-2"},t._l(t.types,(function(r){return e("div",{key:r.identifier,staticClass:"ns-numpad-key info h-56 flex items-center justify-center flex-col cursor-pointer border",class:r.selected?"active":"",on:{click:function(e){return t.select(r.identifier)}}},[e("img",{staticClass:"w-32 h-32",attrs:{src:r.icon,alt:""}}),t._v(" "),e("h4",{staticClass:"font-semibold text-xl my-2"},[t._v(t._s(r.label))])])})),0):t._e()])}),[],!1,null,null,null).exports},3287:(t,e,r)=>{r.d(e,{Z:()=>u});var n=r(1487),s=r(8094),o=r(2867),i=r(8321),a=r(9693);const c={components:{nsNumpad:i.Z,nsNumpadPlus:a.Z},data:function(){return{finalValue:1,virtualStock:null,options:{},optionsSubscription:null,allSelected:!0,isLoading:!1}},beforeDestroy:function(){this.optionsSubscription.unsubscribe()},mounted:function(){var t=this;this.optionsSubscription=POS.options.subscribe((function(e){t.options=e})),this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())})),this.$popupParams.product.quantity&&(this.finalValue=this.$popupParams.product.quantity),this.popupCloser()},destroyed:function(){nsHotPress.destroy("pos-quantity-numpad"),nsHotPress.destroy("pos-quantity-backspace"),nsHotPress.destroy("pos-quantity-enter")},methods:{__:s.__,popupCloser:o.Z,closePopup:function(){this.$popupParams.reject(!1),this.$popup.close()},updateQuantity:function(t){this.finalValue=t},defineQuantity:function(t){var e=this.$popupParams,r=e.product,o=e.data;if(0===t)return n.kX.error((0,s.__)("Please provide a quantity")).subscribe();if("enabled"===r.$original().stock_management&&"materialized"===r.$original().type){var i=POS.getStockUsage(r.$original().id,o.unit_quantity_id)-(r.quantity||0);if(t>parseFloat(o.$quantities().quantity)-i)return n.kX.error((0,s.__)("Unable to add the product, there is not enough stock. Remaining %s").replace("%s",o.$quantities().quantity-i)).subscribe()}this.resolve({quantity:t})},resolve:function(t){this.$popupParams.resolve(t),this.$popup.close()}}};const u=(0,r(1900).Z)(c,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box shadow min-h-2/5-screen w-3/4-screen md:w-3/5-screen lg:w-2/5-screen xl:w-2/5-screen relative"},[t.isLoading?e("div",{staticClass:"flex w-full h-full absolute top-O left-0 items-center justify-center",staticStyle:{background:"rgb(202 202 202 / 49%)"},attrs:{id:"loading-overlay"}},[e("ns-spinner")],1):t._e(),t._v(" "),e("div",{staticClass:"flex-shrink-0 flex justify-between items-center p-2 border-b ns-box-header"},[e("div",[e("h1",{staticClass:"text-xl font-bold text-primary text-center"},[t._v(t._s(t.__("Define Quantity")))])]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.closePopup()}}})],1)]),t._v(" "),e("div",{staticClass:"h-24 border-b primary ns-box-body flex items-center justify-center",attrs:{id:"screen"}},[e("h1",{staticClass:"font-bold text-3xl"},[t._v(t._s(t.finalValue))])]),t._v(" "),"default"===t.options.ns_pos_numpad?e("ns-numpad",{attrs:{floating:t.options.ns_pos_allow_decimal_quantities,value:t.finalValue},on:{changed:function(e){return t.updateQuantity(e)},next:function(e){return t.defineQuantity(e)}}}):t._e(),t._v(" "),"advanced"===t.options.ns_pos_numpad?e("ns-numpad-plus",{attrs:{value:t.finalValue},on:{changed:function(e){return t.updateQuantity(e)},next:function(e){return t.defineQuantity(e)}}}):t._e()],1)}),[],!1,null,null,null).exports},4054:(t,e,r)=>{r.d(e,{Z:()=>d});var n=r(1487),s=r(3216),o=r(3658);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){u(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function u(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===i(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const l={name:"ns-pos-shipping-popup",computed:{activeTabFields:function(){if(null!==this.tabs)for(var t in this.tabs)if(this.tabs[t].active)return this.tabs[t].fields;return[]},useBillingInfo:function(){return null!==this.tabs?this.tabs.billing.fields[0].value:new Object},useShippingInfo:function(){return null!==this.tabs?this.tabs.shipping.fields[0].value:new Object}},destroyed:function(){this.orderSubscription.unsubscribe()},mounted:function(){var t=this;this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&t.resolveIfQueued(!1)})),this.orderSubscription=POS.order.subscribe((function(e){return t.order=e})),this.loadForm()},data:function(){return{tabs:null,orderSubscription:null,order:null,formValidation:new o.Z}},watch:{useBillingInfo:function(t){var e=this;1===t&&this.tabs.billing.fields.forEach((function(t){"_use_customer_billing"!==t.name&&(t.value=e.order.customer.billing?e.order.customer.billing[t.name]:t.value)}))},useShippingInfo:function(t){var e=this;1===t&&this.tabs.shipping.fields.forEach((function(t){"_use_customer_shipping"!==t.name&&(t.value=e.order.customer.shipping?e.order.customer.shipping[t.name]:t.value)}))}},methods:{__,resolveIfQueued:s.Z,submitInformations:function(){var t=this.formValidation.extractForm({tabs:this.tabs});for(var e in t.general)["shipping","shipping_rate"].includes(e)&&(t.general[e]=parseFloat(t.general[e]));this.order=c(c({},this.order),t.general),delete t.general,delete t.shipping._use_customer_shipping,delete t.billing._use_customer_billing,this.order.addresses=t,POS.order.next(this.order),POS.refreshCart(),this.resolveIfQueued(!0)},closePopup:function(){this.resolveIfQueued(!1)},toggle:function(t){for(var e in this.tabs)this.tabs[e].active=!1;this.tabs[t].active=!0},loadForm:function(){var t=this;n.ih.get("/api/nexopos/v4/forms/ns.pos-addresses").subscribe((function(e){var r=e.tabs,n=function(e){"general"===e?r[e].fields.forEach((function(e){e.value=t.order[e.name]||""})):r[e].fields.forEach((function(r){r.value=t.order.addresses[e]?t.order.addresses[e][r.name]:""}))};for(var s in r)n(s);t.tabs=t.formValidation.initializeTabs(r)}))}}};const d=(0,r(1900).Z)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"ns-box w-6/7-screen md:w-4/5-screen lg:w-3/5-screen h-6/7-screen md:h-4/5-screen shadow-lg flex flex-col overflow-hidden"},[e("div",{staticClass:"p-2 border-b ns-box-header flex justify-between items-center"},[e("h3",{staticClass:"font-bold text-primary"},[t._v(t._s(t.__("Shipping & Billing")))]),t._v(" "),e("div",{staticClass:"tools"},[e("button",{staticClass:"ns-close-button rounded-full h-8 w-8 border items-center justify-center",on:{click:function(e){return t.closePopup()}}},[e("i",{staticClass:"las la-times"})])])]),t._v(" "),e("div",{staticClass:"flex-auto ns-box-body p-2 overflow-y-auto ns-tab"},[e("div",{attrs:{id:"tabs-container"}},[e("div",{staticClass:"header flex",staticStyle:{"margin-bottom":"-1px"}},t._l(t.tabs,(function(r,n){return e("div",{key:n,staticClass:"tab rounded-tl rounded-tr border tab px-3 py-2 text-primary cursor-pointer",class:r.active?"border-b-0 active":"inactive",staticStyle:{"margin-right":"-1px"},on:{click:function(e){return t.toggle(n)}}},[t._v(t._s(r.label))])})),0),t._v(" "),e("div",{staticClass:"border ns-tab-item"},[e("div",{staticClass:"px-4"},[e("div",{staticClass:"-mx-4 flex flex-wrap"},t._l(t.activeTabFields,(function(r,n){return e("div",{key:n,class:"p-4 w-full md:w-1/2 lg:w-1/3"},[e("ns-field",{attrs:{field:r},on:{blur:function(e){return t.formValidation.checkField(r)},change:function(e){return t.formValidation.checkField(r)}}})],1)})),0)])])])]),t._v(" "),e("div",{staticClass:"p-2 flex justify-between border-t ns-box-footer"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.submitInformations()}}},[t._v(t._s(t.__("Save")))])],1)])])}),[],!1,null,null,null).exports},5178:(t,e,r)=>{r.r(e),r.d(e,{default:()=>s});const n={data:function(){return{title:"",message:"",input:""}},computed:{size:function(){return this.$popupParams.size||"h-full w-full"}},mounted:function(){var t=this;this.input=this.$popupParams.input||"",this.title=this.$popupParams.title,this.message=this.$popupParams.message,this.$popup.event.subscribe((function(e){"click-overlay"===e.event&&(t.$popupParams.reject(!1),t.$popup.close())}))},methods:{__:r(8094).__,emitAction:function(t){this.$popupParams.onAction(t?this.input:t),this.$popup.close()},reject:function(t){void 0!==this.$popupParams.reject&&this.$popupParams.reject(t),this.$popup.close()}}};const s=(0,r(1900).Z)(n,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-5/7-screen md:w-3/7-screen flex flex-col shadow-lg",class:t.size,attrs:{id:"prompt-popup"}},[e("div",{staticClass:"flex items-center justify-center flex-col flex-auto p-2"},[e("h2",{staticClass:"text-3xl font-body"},[t._v(t._s(t.title))]),t._v(" "),e("p",{staticClass:"w-full md:mx-auto md:w-2/3 py-4 text-center"},[t._v(t._s(t.message))])]),t._v(" "),e("div",{staticClass:"p-2"},[e("div",{staticClass:"ns-input"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.input,expression:"input"}],staticClass:"w-full border-2 p-2",attrs:{name:"",id:"",cols:"30",rows:"10"},domProps:{value:t.input},on:{input:function(e){e.target.composing||(t.input=e.target.value)}}})])]),t._v(" "),e("div",{staticClass:"flex border-t action-buttons"},[e("button",{staticClass:"flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.emitAction(!0)}}},[t._v(t._s(t.__("Ok")))]),t._v(" "),e("hr",{staticClass:"border-r"}),t._v(" "),e("button",{staticClass:"flex-auto w-1/2 h-16 flex items-center justify-center uppercase",on:{click:function(e){return t.reject(!1)}}},[t._v(t._s(t.__("Cancel")))])])])}),[],!1,null,null,null).exports},2909:(t,e,r)=>{r.d(e,{Z:()=>i});var n=r(2867),s=r(8094);const o={data:function(){return{value:[],options:[],description:"",label:null,type:"select"}},computed:{},mounted:function(){this.popupCloser(),this.value=this.$popupParams.value||[],this.options=this.$popupParams.options,this.label=this.$popupParams.label,this.description=this.$popupParams.description||"",this.type=this.$popupParams.type||this.type},methods:{popupCloser:n.Z,__:s.__,toggle:function(t){var e=this.value.indexOf(t);-1===e?this.value.unshift(t):this.value.splice(e,1)},isSelected:function(t){return this.value.indexOf(t)>=0},close:function(){this.$popupParams.reject(!1),this.$popup.close()},select:function(t){void 0!==t&&(this.value=[t]),this.$popupParams.resolve(this.value),this.close()}}};const i=(0,r(1900).Z)(o,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"shadow-xl ns-box w-6/7-screen md:w-4/7-screen lg:w-3/7-screen max-h-5/6-screen overflow-hidden flex flex-col"},[e("div",{staticClass:"p-2 flex justify-between border-b items-center ns-box-header"},[e("span",{staticClass:"text-semibold text-primary"},[t._v("\n            "+t._s(t.label)+"\n        ")]),t._v(" "),e("div",[e("ns-close-button",{on:{click:function(e){return t.close()}}})],1)]),t._v(" "),e("div",{staticClass:"flex flex-col overflow-hidden"},[t.description.length>0?e("p",{staticClass:"p-2 text-center text-sm bg-info-primary"},[t._v(t._s(t.description))]):t._e(),t._v(" "),e("div",{staticClass:"overflow-y-auto"},[e("ul",{staticClass:"ns-vertical-menu"},["select"===t.type?t._l(t.options,(function(r){return e("li",{key:r.value,staticClass:"p-2 border-b border-box-edge text-primary cursor-pointer",on:{click:function(e){return t.select(r)}}},[t._v(t._s(r.label))])})):t._e(),t._v(" "),"multiselect"===t.type?t._l(t.options,(function(r){return e("li",{key:r.value,staticClass:"p-2 border-b text-primary cursor-pointer",class:t.isSelected(r)?"active":"",on:{click:function(e){return t.toggle(r)}}},[t._v(t._s(r.label))])})):t._e()],2)])]),t._v(" "),"multiselect"===t.type?e("div",{staticClass:"flex justify-between"},[e("div"),t._v(" "),e("div",[e("ns-button",{attrs:{type:"info"},on:{click:function(e){return t.select()}}},[t._v(t._s(t.__("Select")))])],1)]):t._e()])}),[],!1,null,null,null).exports}}]);